<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIPP - Sistem Informasi Perawatan dan Perbaikan</title>

    <!-- Link ke Font Awesome untuk Ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Link ke Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts (Roboto) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* CSS Khusus untuk Sidebar (di luar Tailwind) */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8fafc; /* Tailwind gray-50 */
            display: flex;
            overflow-x: hidden; /* Mencegah horizontal scroll di body */
        }

        /* Kontainer Sidebar Utama */
        .sidebar {
            width: 280px;
            height: 100vh;
            position: fixed; /* Tetap di kiri */
            top: 0;
            left: 0;
            background-color: #0d47a1; /* Biru tua */
            color: #ffffff;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            transition: transform 0.3s ease; /* Transisi untuk slide-in/out */
            z-index: 50;
            /* Default tersembunyi di mobile, terlihat di desktop */
            transform: translateX(-100%);
        }

        /* State sidebar terlihat di desktop (md dan lebih besar) */
        @media (min-width: 768px) {
            .sidebar {
                transform: translateX(0);
            }
        }

        /* State sidebar terlihat (saat di-toggle di mobile) */
        .sidebar.active {
            transform: translateX(0);
        }

        /* Header Sidebar */
        .sidebar-header {
            padding: 25px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: 700;
        }

        .sidebar-header p {
            margin: 0;
            font-size: 10px;
            font-weight: 400;
            letter-spacing: 0.5px;
            opacity: 0.8;
        }

        /* Search Bar */
        .sidebar-search {
            padding: 20px;
            position: relative;
        }

        .sidebar-search input {
            width: 100%;
            padding: 10px 15px 10px 40px;
            border-radius: 20px;
            border: none;
            background-color: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            font-size: 14px;
        }

        .sidebar-search input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .sidebar-search .fa-search {
            position: absolute;
            left: 35px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
        }

        /* Menu Navigasi */
        .sidebar-menu {
            list-style: none;
            flex-grow: 1; /* Mendorong footer ke bawah */
            padding: 10px 0;
        }

        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 14px 25px;
            color: #ffffff;
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            transition: background-color 0.3s, padding-left 0.3s;
            position: relative;
        }

        .sidebar-menu li a .menu-icon {
            font-size: 18px;
            width: 20px;
            text-align: center;
            margin-right: 15px;
            opacity: 0.9;
        }

        /* Efek Hover */
        .sidebar-menu li a:hover,
        .sidebar-menu li a.active-link { /* Class untuk link yang sedang aktif */
            background-color: #1565c0; /* Biru sedikit lebih cerah */
            padding-left: 30px;
        }

        /* Ikon Chevron (panah) */
        .sidebar-menu .chevron {
            position: absolute;
            right: 20px;
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        /* State saat dropdown terbuka */
        .sidebar-menu li a.dropdown-active .chevron {
            transform: rotate(90deg);
        }

        .sidebar-menu li a.dropdown-active {
              background-color: #1565c0;
        }


        /* Sub-menu */
        .sub-menu {
            list-style: none;
            background-color: #0b3c8a; /* Biru lebih gelap */
            max-height: 0; /* Sembunyi secara default */
            overflow: hidden;
            transition: max-height 0.4s ease-out; /* Animasi expand/collapse */
        }

        .sub-menu li a {
            padding-top: 12px;
            padding-bottom: 12px;
            padding-left: 35px; /* Lebih menjorok ke dalam */
            font-size: 14px;
            font-weight: 400;
            opacity: 0.9;
        }

        .sub-menu li a .menu-icon {
            font-size: 14px;
            margin-right: 12px;
        }

        .sub-menu li a:hover,
        .sub-menu li a.active-link {
            background-color: #1565c0;
            opacity: 1;
            padding-left: 40px;
        }


        /* Footer Sidebar */
        .sidebar-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-footer a {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: background-color 0.3s;
        }

        .sidebar-footer a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .sidebar-footer a .menu-icon {
            margin-right: 10px;
            font-size: 16px;
        }

        /* --- STYLING KONTEN UTAMA (RESPONSIVE) --- */
        .main-content {
            flex-grow: 1;
            /* Margin 0 di mobile, 280px di desktop */
            margin-left: 0px;
            transition: margin-left 0.3s ease;
            height: 100vh;
            display: flex;
            flex-direction: column;
            width: 100%; /* Mengisi sisa ruang */
        }

        @media (min-width: 768px) {
            .main-content {
                margin-left: 280px;
                width: calc(100% - 280px); /* Kalkulasi lebar */
            }
        }


        /* Header Konten (User Avatar) */
        .main-header {
            background-color: #ffffff;
            padding: 1rem 1.5rem; /* p-4 px-6 */
            border-bottom: 1px solid #e2e8f0; /* border-b border-gray-200 */
            /* Di mobile: justify-between. Di desktop: justify-end */
            display: flex;
            justify-content: space-between; /* Untuk hamburger & user */
            align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            flex-shrink: 0; /* Mencegah header menyusut */
        }

        @media (min-width: 768px) {
            .main-header {
                justify-content: flex-end; /* Kembali ke user di kanan */
            }
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem; /* gap-3 */
        }
        .user-profile span {
            font-weight: 500;
            color: #374151; /* text-gray-700 */
        }
        .user-profile .avatar {
            width: 40px;
            height: 40px;
            border-radius: 9999px; /* rounded-full */
            background-color: #dbeafe; /* bg-blue-100 */
            color: #1d4ed8; /* text-blue-700 */
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        .user-profile .avatar i {
            font-size: 1.1rem;
        }


        /* Area Konten yang Bisa Scroll */
        .page-container {
            flex-grow: 1;
            overflow-y: auto; /* Hanya area ini yang scroll */
            padding: 1rem; /* p-4 di mobile */
        }

        @media (min-width: 768px) {
             .page-container {
                 padding: 1.5rem; /* p-6 di desktop */
             }
        }


        /* Kontainer untuk setiap halaman */
        .page-content {
            display: none; /* Sembunyikan semua halaman by default */
        }

        .page-content.active {
            display: block; /* Tampilkan halaman yang aktif */
        }

        /* Breadcrumbs */
        .breadcrumbs {
            color: #94a3b8; /* text-slate-400 */
            font-size: 0.875rem; /* text-sm */
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .breadcrumbs span {
             margin: 0 0.25rem; /* mx-1 */
        }
        .breadcrumbs strong {
             color: #475569; /* text-slate-600 */
             font-weight: 500;
        }


        /* Helper class untuk card */
        .card {
            background-color: #ffffff;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); /* shadow-md */
            padding: 1rem; /* p-4 di mobile */
        }

        @media (min-width: 768px) {
            .card {
                padding: 1.5rem; /* p-6 di desktop */
            }
        }

        /* Status Priority di Tabel */
        .priority-high { background-color: #fecaca; color: #dc2626; } /* Red-100/700 */
        .priority-medium { background-color: #fef3c7; color: #d97706; } /* Yellow-100/700 */
        .priority-low { background-color: #dbeafe; color: #1d4ed8; } /* Blue-100/700 */
        .priority-tag { font-size: 0.75rem; padding: 0.25rem 0.5rem; border-radius: 0.75rem; font-weight: 600; white-space: nowrap;}


        /* Styling untuk Kalender (Mockup) */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, minmax(0, 1fr));
            gap: 4px;
        }
        .calendar-day {
            aspect-ratio: 1 / 1;
            padding: 4px; /* Padding lebih kecil untuk ruang dot */
            border: 1px solid #e2e8f0; /* border-gray-200 */
            border-radius: 0.25rem; /* rounded */
            position: relative;
            cursor: pointer;
            font-size: 0.75rem; /* Kecilkan font di mobile */
            text-align: center;
        }
        @media (min-width: 768px) {
             .calendar-day {
                 font-size: 1rem;
                 padding: 8px;
             }
        }
        .calendar-day-header {
            text-align: center;
            font-weight: 500;
            padding-bottom: 8px;
            font-size: 0.75rem;
        }
        @media (min-width: 768px) {
             .calendar-day-header {
                 font-size: 1rem;
             }
        }
        .calendar-day:hover {
            background-color: #f1f5f9; /* bg-gray-100 */
        }
        /* Style untuk tanggal yang memiliki jadwal */
        .calendar-day.has-schedule {
            background-color: #eff6ff; /* bg-blue-50 */
            border-color: #bfdbfe; /* border-blue-200 */
        }
        .calendar-day.has-schedule:hover {
            background-color: #dbeafe; /* bg-blue-100 */
        }
        .calendar-day .event-count {
            width: 20px;
            height: 20px;
            line-height: 20px;
            border-radius: 9999px; /* rounded-full */
            background-color: #2563eb; /* bg-blue-600 */
            color: white;
            position: absolute;
            bottom: 4px;
            right: 4px;
            font-size: 10px;
            font-weight: bold;
            display: block;
        }
        @media (min-width: 768px) {
            .calendar-day .event-count {
                 bottom: 8px;
                 right: 8px;
            }
        }

        /* Styling untuk List Detail Kalender */
        .detail-item-list {
            list-style: none;
            padding: 0;
        }
        .detail-item {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.875rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid;
        }

        .detail-item-low { background-color: #e0f2fe; border-color: #93c5fd; } /* Blue-100 */
        .detail-item-medium { background-color: #fef9c3; border-color: #fde047; } /* Yellow-100 */
        .detail-item-high { background-color: #fee2e2; border-color: #fca5a5; } /* Red-100 */


        /* Styling untuk CSS Bar Chart */
        .chart-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            width: 100%;
            height: 430px; /* h-80 */
            padding: 20px 20px 30px 40px; /* Ruang lebih di kiri untuk label Y */
            border-left: 2px solid #e5e7eb; /* border-gray-200 */
            border-bottom: 2px solid #e5e7eb;
            position: relative; /* Untuk label sumbu Y */
        }
        /* Label Sumbu Y (FIXED POSITION) */
        .y-axis-label {
            position: absolute;
            left: 25px; /* Posisikan di kiri border */
            transform: translateY(50%); /* Pusatkan vertikal */
            font-size: 12px;
            color: #6b7280;
        }
         .y-axis-label-high { /* Ganti dari y-axis-label */
             bottom: calc(100% - 20px); /* Atas chart */
        }
         .y-axis-label-mid {
             bottom: 50%;
        }
         .y-axis-label-low {
             bottom: 30px; /* Dekat sumbu X */
        }

        .chart-bar {
            width: 30px;
            background-color: #3b82f6; /* bg-blue-500 */
            border-radius: 4px 4px 0 0;
            position: relative;
            text-align: center;
            color: #6b7280; /* text-gray-500 */
            font-size: 12px;
            font-weight: 500;
            transition: height 0.5s ease-out, background-color 0.3s;
        }
        .chart-bar:hover {
            background-color: #2563eb; /* bg-blue-600 */
        }
        /* Label bulan */
        .chart-bar .label {
            position: absolute;
            bottom: -20px;
            width: 100%;
            left: 0;
        }
        /* Nilai di atas bar */
        .chart-bar .value {
            position: absolute;
            top: -20px; /* Posisi di atas bar */
            left: 50%;
            transform: translateX(-50%);
            color: #1f2937; /* text-gray-800 */
            font-size: 12px;
            font-weight: 600;
            opacity: 0; /* Sembunyi dulu */
             transition: opacity 0.3s;
        }
        /* Tampilkan nilai saat hover atau saat chart dimuat */
        .chart-container:hover .chart-bar .value,
        .chart-bar.show-value .value {
            opacity: 1;
        }


        /* Zebra Stripe untuk semua tabel data */
        .page-content table tbody tr:nth-child(even) {
            background-color: #f9fafb; /* bg-gray-50 */
        }
        .page-content table tbody tr:hover {
            background-color: #f1f5f9; /* hover:bg-gray-100 */
        }

        /* Overlay untuk sidebar mobile */
        #sidebar-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 40; /* Di bawah sidebar */
            transition: opacity 0.3s ease;
        }

        /* Utility class untuk tombol hamburger */
        .hamburger-btn {
            color: #4b5563; /* text-gray-600 */
            padding: 0.5rem; /* p-2 */
            border-radius: 0.375rem; /* rounded-md */
        }
        .hamburger-btn:hover {
            background-color: #f3f4f6; /* hover:bg-gray-100 */
            color: #1f2937; /* hover:text-gray-800 */
        }

        /* Tombol Aksi Admin */
        .admin-action-buttons {
            display: flex;
            gap: 0.5rem; /* Jarak antar tombol */
            margin-top: 1rem; /* Jarak dari konten di atasnya */
        }

    </style>
</head>
<body>

    <!-- Overlay untuk Sidebar Mobile -->
    <div id="sidebar-overlay" class="hidden md:hidden"></div>

    <!-- ======== SIDEBAR ======== -->
    <nav id="sidebar" class="sidebar">
        <!-- Header -->
        <div class="sidebar-header">
            <h2>SIPP</h2>
            <p>SISTEM INFORMASI PERAWATAN DAN PERBAIKAN</p>
        </div>

        <!-- Search Bar -->
        <div class="sidebar-search">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Cari menu...">
        </div>

        <!-- Menu List -->
        <ul class="sidebar-menu">
            <!-- Item 1: Dashboard -->
            <li>
                <a href="#dashboard" class="menu-link active-link" data-breadcrumb="Dashboard">
                    <i class="fas fa-tachometer-alt menu-icon"></i>
                    <span>Dashboard</span>
                </a>
            </li>

            <!-- Item 2: Master Data -->
            <li>
                <a href="#" class="dropdown-toggle menu-link" data-breadcrumb="Master Data">
                    <i class="fas fa-database menu-icon"></i>
                    <span>Master Data</span>
                    <i class="fas fa-chevron-right chevron"></i>
                </a>
                <ul class="sub-menu">
                    <li><a href="#master-barang" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Barang"><i class="fas fa-box menu-icon"></i><span>Master Barang</span></a></li>
                    <li><a href="#master-gedung" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Gedung"><i class="fas fa-building menu-icon"></i><span>Master Gedung</span></a></li>
                    <li><a href="#master-lantai" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Lantai"><i class="fas fa-layer-group menu-icon"></i><span>Master Lantai Gedung</span></a></li>
                    <li><a href="#master-ruangan" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Ruangan"><i class="fas fa-door-open menu-icon"></i><span>Master Ruangan</span></a></li>
                    <li><a href="#master-satker" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Satker"><i class="fas fa-sitemap menu-icon"></i><span>Master Satker</span></a></li>
                    <li><a href="#master-jenis" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Jenis"><i class="fas fa-tags menu-icon"></i><span>Master Jenis Barang</span></a></li>
                    <li><a href="#master-kondisi" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Kondisi"><i class="fas fa-clipboard-check menu-icon"></i><span>Master Kondisi Barang</span></a></li>
                </ul>
            </li>

            <!-- Item 3: Perawatan -->
            <li>
                <a href="#" class="dropdown-toggle menu-link" data-breadcrumb="Perawatan">
                    <i class="fas fa-tasks menu-icon"></i>
                    <span>Perawatan</span>
                    <i class="fas fa-chevron-right chevron"></i>
                </a>
                <ul class="sub-menu">
                    <li><a href="#jadwal-perawatan" class="menu-link" data-breadcrumb="Perawatan<span>/</span>Jadwal Perawatan"><i class="fas fa-calendar-alt menu-icon"></i><span>Jadwal Perawatan</span></a></li>
                    <li><a href="#pengajuan-perawatan" class="menu-link" data-breadcrumb="Perawatan<span>/</span>Pengajuan"><i class="fas fa-file-signature menu-icon"></i><span>Pengajuan Perawatan</span></a></li>
                    <li><a href="#riwayat-pengajuan-perawatan" class="menu-link" data-breadcrumb="Perawatan<span>/</span>Riwayat Pengajuan"><i class="fas fa-history menu-icon"></i><span>Riwayat Pengajuan</span></a></li>
                    <li><a href="#riwayat-pelaksanaan-perawatan" class="menu-link" data-breadcrumb="Perawatan<span>/</span>Riwayat Pelaksanaan"><i class="fas fa-check-circle menu-icon"></i><span>Riwayat Pelaksanaan</span></a></li>
                      <!-- Link tersembunyi untuk detail, breadcrumb diatur via JS -->
                      <li style="display: none;"><a href="#detail-riwayat-perawatan" class="menu-link" data-breadcrumb="Perawatan<span>/</span>Riwayat Pengajuan<span>/</span>Detail"></a></li>
                </ul>
            </li>

            <!-- Item 4: Perbaikan -->
            <li>
                <a href="#" class="dropdown-toggle menu-link" data-breadcrumb="Perbaikan">
                    <i class="fas fa-tools menu-icon"></i>
                    <span>Perbaikan</span>
                    <i class="fas fa-chevron-right chevron"></i>
                </a>
                <ul class="sub-menu">
                    <li><a href="#pengajuan-perbaikan" class="menu-link" data-breadcrumb="Perbaikan<span>/</span>Pengajuan"><i class="fas fa-file-signature menu-icon"></i><span>Pengajuan Perbaikan</span></a></li>
                    <li><a href="#riwayat-pengajuan-perbaikan" class="menu-link" data-breadcrumb="Perbaikan<span>/</span>Riwayat Pengajuan"><i class="fas fa-history menu-icon"></i><span>Riwayat Pengajuan</span></a></li>
                    <li><a href="#riwayat-pelaksanaan-perbaikan" class="menu-link" data-breadcrumb="Perbaikan<span>/</span>Riwayat Pelaksanaan"><i class="fas fa-check-circle menu-icon"></i><span>Riwayat Pelaksanaan</span></a></li>
                      <!-- Link tersembunyi untuk detail -->
                     <li style="display: none;"><a href="#detail-riwayat-perbaikan" class="menu-link" data-breadcrumb="Perbaikan<span>/</span>Riwayat Pengajuan<span>/</span>Detail"></a></li>
                </ul>
            </li>

            <!-- Item 5: User & Hak Akses -->
            <li>
                <a href="#" class="dropdown-toggle menu-link" data-breadcrumb="User & Hak Akses">
                    <i class="fas fa-users-cog menu-icon"></i>
                    <span>User & Hak Akses</span>
                    <i class="fas fa-chevron-right chevron"></i>
                </a>
                <ul class="sub-menu">
                    <li><a href="#master-user" class="menu-link" data-breadcrumb="User & Hak Akses<span>/</span>Master User"><i class="fas fa-user-friends menu-icon"></i><span>Master User</span></a></li>
                    <!-- SUBMENU BARU: MASTER ROLE (HAK AKSES) -->
                    <li><a href="#master-role" class="menu-link" data-breadcrumb="User & Hak Akses<span>/</span>Master Role"><i class="fas fa-user-shield menu-icon"></i><span>Master Role</span></a></li>
                    <li><a href="#master-hak-akses" class="menu-link" data-breadcrumb="User & Hak Akses<span>/</span>Hak Akses"><i class="fas fa-user-shield menu-icon"></i><span>Master Hak Akses (Lama)</span></a></li>
                </ul>
            </li>
              <!-- Link tersembunyi untuk detail barang -->
              <li style="display: none;"><a href="#detail-barang" class="menu-link" data-breadcrumb="Master Data<span>/</span>Master Barang<span>/</span>Detail"></a></li>
        </ul>

        <!-- Footer -->
        <div class="sidebar-footer">
            <a href="#">
                <i class="fas fa-sign-out-alt menu-icon"></i>
                <span>Logout</span>
            </a>
        </div>
    </nav>

    <!-- ======== KONTEN UTAMA HALAMAN ======== -->
    <div id="main-content" class="main-content">

        <!-- HEADER KONTEN (USER AVATAR) -->
        <header class="main-header">
            <!-- Tombol Hamburger (Hanya terlihat di mobile) -->
            <button id="menu-toggle" class="hamburger-btn md:hidden">
                <i class="fas fa-bars fa-lg"></i>
            </button>

            <div class="user-profile">
                <span>Admin UPA</span> <!-- Nama diubah -->
                <div class="avatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        </header>

        <!-- CONTAINER UNTUK HALAMAN YANG BISA SCROLL -->
        <div class="page-container">

            <!-- ========= HALAMAN: DASHBOARD (UPDATED) ========= -->
          <div id="dashboard" class="page-content active">
    <div id="breadcrumb-dashboard" class="breadcrumbs">Dashboard</div>

    <h1 class="text-3xl font-bold text-gray-800">Dashboard</h1>
    <p class="text-lg text-gray-600 mb-6">Laporan Bulan: <span class="font-semibold text-gray-800">Oktober 2025</span></p>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">

    <div class="card">
        <div class="flex flex-col">
            <div class="flex items-center justify-between mb-1">
                <p class="text-sm font-medium text-gray-500">Perawatan (Oktober)</p>
                <div class="p-2 rounded-full bg-blue-100 text-blue-600">
                    <i class="fas fa-tasks fa-sm"></i>
                </div>
            </div>
            <p class="text-3xl font-bold text-blue-600" id="stat-perawatan-bulan-ini">12</p>
            <p class="text-xs text-gray-500 mt-2" id="stat-total-perawatan">45 Total Perawatan (Semua Status)</p>
        </div>
    </div>

    <div class="card">
        <div class="flex flex-col">
            <div class="flex items-center justify-between mb-1">
                <p class="text-sm font-medium text-gray-500">Perbaikan (Oktober)</p>
                <div class="p-2 rounded-full bg-yellow-100 text-yellow-600">
                    <i class="fas fa-exclamation-triangle fa-sm"></i>
                </div>
            </div>
            <p class="text-3xl font-bold text-yellow-600" id="stat-perbaikan-mendesak">3</p>
            <p class="text-xs text-gray-500 mt-2" id="stat-total-perbaikan">18 Total Perbaikan (Semua Status)</p>
        </div>
    </div>

    <div class="card">
        <div class="flex flex-col">
            <div class="flex items-center justify-between mb-1">
                <p class="text-sm font-medium text-gray-500">Selesai (Oktober)</p>
                <div class="p-2 rounded-full bg-green-100 text-green-600">
                    <i class="fas fa-check-circle fa-sm"></i>
                </div>
            </div>
            <p class="text-3xl font-bold text-green-600" id="stat-selesai-bulan-ini">9</p>
            <p class="text-xs text-gray-500 mt-2" id="stat-total-selesai">63 Total Selesai Dikerjakan</p>
        </div>
    </div>

    <div class="card">
        <div class="flex flex-col">
            <div class="flex items-center justify-between mb-1">
                <p class="text-sm font-medium text-gray-500">Total Barang Terdata</p>
                <div class="p-2 rounded-full bg-gray-100 text-gray-600">
                    <i class="fas fa-box fa-sm"></i>
                </div>
            </div>
            <p class="text-3xl font-bold text-gray-600" id="stat-total-barang">1,204</p>
            <p class="text-xs text-gray-500 mt-2">Di semua Satuan Kerja</p>
        </div>
    </div>
</div>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

        <div class="lg:col-span-2 card">
            <div class="flex flex-wrap justify-between items-center mb-4 gap-2">
                <h2 class="text-xl font-semibold text-gray-800">Grafik Perawatan per Bulan</h2>
                <div class="flex items-center gap-2">
                    <select id="chart-semester-select" class="border border-gray-300 rounded-lg p-1 text-sm">
                        <option value="all">Semua Semester</option>
                        <option value="1">Semester Ganjil (Jul-Des)</option>
                        <option value="2">Semester Genap (Jan-Jun)</option>
                    </select>
                    <select id="chart-year-select" class="border border-gray-300 rounded-lg p-1 text-sm">
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                    </select>
                </div>
            </div>

            <div class="chart-container" id="chart-container">
                <div class="chart-y-axis">
                    <span>100</span>
                    <span>50</span>
                    <span>0</span>
                </div>
                <div class="chart-grid-line" style="bottom: 100%;"></div>
                <div class="chart-grid-line" style="bottom: 50%;"></div>
                <div class="chart-grid-line" style="bottom: 0;"></div>

                <div class="chart-bars">
                    <div class="chart-bar-item" data-month="1">
                        <div class="bar" style="height: 30%;"></div> <span class="bar-label">Jan</span>
                    </div>
                    <div class="chart-bar-item" data-month="2">
                        <div class="bar" style="height: 45%;"></div> <span class="bar-label">Feb</span>
                    </div>
                    <div class="chart-bar-item" data-month="3">
                        <div class="bar" style="height: 20%;"></div> <span class="bar-label">Mar</span>
                    </div>
                    <div class="chart-bar-item" data-month="4">
                        <div class="bar" style="height: 55%;"></div> <span class="bar-label">Apr</span>
                    </div>
                    <div class="chart-bar-item" data-month="5">
                        <div class="bar" style="height: 70%;"></div> <span class="bar-label">Mei</span>
                    </div>
                    <div class="chart-bar-item" data-month="6">
                        <div class="bar" style="height: 60%;"></div> <span class="bar-label">Jun</span>
                    </div>
                    <div class="chart-bar-item" data-month="7">
                        <div class="bar" style="height: 40%;"></div> <span class="bar-label">Jul</span>
                    </div>
                    <div class="chart-bar-item" data-month="8">
                        <div class="bar" style="height: 80%;"></div> <span class="bar-label">Agt</span>
                    </div>
                    <div class="chart-bar-item" data-month="9">
                        <div class="bar" style="height: 50%;"></div> <span class="bar-label">Sep</span>
                    </div>
                    <div class="chart-bar-item" data-month="10">
                        <div class="bar" style="height: 90%;"></div> <span class="bar-label">Okt</span>
                    </div>
                    <div class="chart-bar-item" data-month="11">
                        <div class="bar" style="height: 30%;"></div> <span class="bar-label">Nov</span>
                    </div>
                    <div class="chart-bar-item" data-month="12">
                        <div class="bar" style="height: 25%;"></div> <span class="bar-label">Des</span>
                    </div>
                </div>
            </div>
            </div>

        <div class="lg:col-span-1 space-y-6">
            <div class="card">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Pengajuan Perbaikan Terbaru</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-gray-50 text-xs uppercase text-gray-700">
                            <tr>
                                <th scope="col" class="p-2">Barang</th>
                                <th scope="col" class="p-2">Tgl. Ajuan</th>
                                <th scope="col" class="p-2">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-001" class="menu-link detail-barang-link text-blue-600 hover:underline">Komputer Lab LSI 2</a>
                                </td>
                                <td class="p-2 text-gray-600">26 Okt</td>
                                <td class="p-2">
                                    <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-0.5 rounded">Menunggu</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-002" class="menu-link detail-barang-link text-blue-600 hover:underline">Papan Tulis 7584</a>
                                </td>
                                <td class="p-2 text-gray-600">25 Okt</td>
                                <td class="p-2">
                                    <span class="bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded">Dikerjakan</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-012" class="menu-link detail-barang-link text-blue-600 hover:underline">Kursi Lab LSI 2 (10)</a>
                                </td>
                                <td class="p-2 text-gray-600">25 Okt</td>
                                <td class="p-2">
                                    <span class="bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-0.5 rounded">Menunggu</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-034" class="menu-link detail-barang-link text-blue-600 hover:underline">AC Ruang 712</a>
                                </td>
                                <td class="p-2 text-gray-600">11 Okt</td>
                                <td class="p-2">
                                    <span class="bg-green-100 text-green-800 text-xs font-medium px-2 py-0.5 rounded">Selesai</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Jadwal Perawatan Terdekat</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="bg-gray-50 text-xs uppercase text-gray-700">
                            <tr>
                                <th scope="col" class="p-2">Barang</th>
                                <th scope="col" class="p-2">Jadwal</th>
                                <th scope="col" class="p-2">Prioritas</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-001" class="menu-link detail-barang-link text-blue-600 hover:underline">Komputer Apple Lab LSI 2</a>
                                </td>
                                <td class="p-2 text-gray-600">2 Nov</td>
                                <td class="p-2">
                                    <span class="priority-tag priority-medium">Medium</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-017" class="menu-link detail-barang-link text-blue-600 hover:underline">Proyektor Ruang 712</a>
                                </td>
                                <td class="p-2 text-gray-600">5 Nov</td>
                                <td class="p-2">
                                    <span class="priority-tag priority-high">Tinggi</span>
                                </td>
                            </tr>
                            <tr>
                                <td class="p-2 font-medium text-gray-900 whitespace-nowrap">
                                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-002" class="menu-link detail-barang-link text-blue-600 hover:underline">Papan Tulis 7584</a>
                                </td>
                                <td class="p-2 text-gray-600">5 Nov</td>
                                <td class="p-2">
                                    <span class="priority-tag priority-low">Rendah</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        </div>
</div>

            <!-- ========= HALAMAN: MASTER BARANG (UPDATED KOLOM) ========= -->
            <div id="master-barang" class="page-content">
                 <div id="breadcrumb-master-barang" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Barang</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2">
                                <i class="fas fa-plus"></i><span>Tambah Manual</span></button>
                            <button id="open-import-modal" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2">
                                <i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2">
                                <i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
    <table class="text-left">
        <thead class="bg-gray-50 border-b border-gray-200 text-center">
            <tr>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">No</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">ID Barang</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Nama Barang</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Satuan Kerja</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Kondisi</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Merk</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Tipe</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Umur Aset</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Intra / Extra</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Henti Guna</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Kode Register</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Status Penggunaan</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Tgl. Perolehan</th>
                <th class="p-4 font-semibold text-gray-600 whitespace-nowrap">Aksi</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200 text-sm">
            <tr>
                <td class="p-4 text-gray-700 whitespace-nowrap">1</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">BRG-001</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">
                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-001" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Komputer Apple Lab LSI 2</a>
                </td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Administrasi Niaga</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">
                    <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Baik</span>
                </td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Apple</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Macbook Pro</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">5 Tahun</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Intra</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Tidak</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">E0E36F07...</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Digunakan sendiri</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">2020-01-15</td>
                <td class="p-4 flex gap-2 whitespace-nowrap">
                    <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>

                    <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                </td>
            </tr>
            <tr>
                <td class="p-4 text-gray-700 whitespace-nowrap">2</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">BRG-002</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">
                    <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-002" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Papan Tulis 7584</a>
                </td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Teknik Elektro</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">
                    <span class="bg-yellow-100 text-yellow-700 text-xs font-medium px-2 py-1 rounded-full">Rusak Ringan</span>
                </td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Lokal</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Whiteboard</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">3 Tahun</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Intra</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Tidak</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">E0E36F07...</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">Digunakan operasional</td>
                <td class="p-4 text-gray-700 whitespace-nowrap">2022-10-01</td>
                <td class="p-4 flex gap-2 whitespace-nowrap">
                    <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                    <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>
                    <div class="flex flex-col sm:flex-row justify-between items-center mt-4 gap-2">
                        <p class="text-sm text-gray-600">Showing 1 to 2 of 50 entries</p>
                        <div class="flex gap-1">
                            <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-1 px-3 rounded-lg">&laquo;</button>
                            <button class="bg-blue-600 text-white font-medium py-1 px-3 rounded-lg">1</button>
                            <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-1 px-3 rounded-lg">2</button>
                            <button class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-1 px-3 rounded-lg">&raquo;</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER GEDUNG ========= -->
            <div id="master-gedung" class="page-content">
                 <div id="breadcrumb-master-gedung" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Gedung</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Kode Gedung</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Gedung</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">GD-SIPL</td>
                                    <td class="p-4 text-gray-700">Gedung Teknik Sipil</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">GD-AKN</td>
                                    <td class="p-4 text-gray-700">Gedung Akuntansi</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER LANTAI GEDUNG ========= -->
            <div id="master-lantai" class="page-content">
                 <div id="breadcrumb-master-lantai" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Lantai Gedung</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Gedung</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Lantai</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">Gedung Teknik Sipil</td>
                                    <td class="p-4 text-gray-700">Lantai 1</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                 <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">Gedung Teknik Sipil</td>
                                    <td class="p-4 text-gray-700">Lantai 2</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER RUANGAN ========= -->
            <div id="master-ruangan" class="page-content">
                 <div id="breadcrumb-master-ruangan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Ruangan</h1>
                <div class="card">
                     <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Ruangan</th>
                                    <th class="p-4 font-semibold text-gray-600">Lantai</th>
                                    <th class="p-4 font-semibold text-gray-600">Gedung</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">Lab LSI 2</td>
                                    <td class="p-4 text-gray-700">Lantai 7</td>
                                    <td class="p-4 text-gray-700">Gedung Teknik Elektro</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER SATKER ========= -->
            <div id="master-satker" class="page-content">
                 <div id="breadcrumb-master-satker" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Satuan Kerja (Satker)</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Kode Satker</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Satker</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">JTI</td>
                                    <td class="p-4 text-gray-700">Jurusan Teknologi Informasi</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">AN</td>
                                    <td class="p-4 text-gray-700">Jurusan Administrasi Niaga</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER JENIS BARANG ========= -->
            <div id="master-jenis" class="page-content">
                 <div id="breadcrumb-master-jenis" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Jenis Barang</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Jenis Barang</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">Elektronik</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">Furnitur</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER KONDISI BARANG ========= -->
            <div id="master-kondisi" class="page-content">
                 <div id="breadcrumb-master-kondisi" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Daftar Master Kondisi Barang</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Kondisi</th>
                                    <th class="p-4 font-semibold text-gray-600">Deskripsi</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700"><span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Baik</span></td>
                                    <td class="p-4 text-gray-700">Barang dalam kondisi normal dan berfungsi.</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700"><span class="bg-yellow-100 text-yellow-700 text-xs font-medium px-2 py-1 rounded-full">Rusak Ringan</span></td>
                                    <td class="p-4 text-gray-700">Barang perlu perawatan atau perbaikan kecil.</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">3</td>
                                    <td class="p-4 text-gray-700"><span class="bg-red-100 text-red-700 text-xs font-medium px-2 py-1 rounded-full">Rusak Berat</span></td>
                                    <td class="p-4 text-gray-700">Barang tidak dapat digunakan.</td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


            <!-- ========= HALAMAN: JADWAL PERAWATAN (UPDATED: FILTER & LIST) ========= -->
            <div id="jadwal-perawatan" class="page-content">
                 <div id="breadcrumb-jadwal-perawatan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Jadwal Perawatan</h1>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kalender -->
                    <div class="lg:col-span-2 card">
                        <div class="flex justify-between items-center mb-4">
                            <button class="text-blue-600 hover:text-blue-800"><i class="fas fa-chevron-left"></i></button>
                            <h2 class="text-xl font-semibold text-gray-800">Oktober 2025</h2>
                            <button class="text-blue-600 hover:text-blue-800"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar-grid">
                              <div class="calendar-day-header">Min</div><div class="calendar-day-header">Sen</div><div class="calendar-day-header">Sel</div><div class="calendar-day-header">Rab</div><div class="calendar-day-header">Kam</div><div class="calendar-day-header">Jum</div><div class="calendar-day-header">Sab</div>
                              <div class="calendar-day text-gray-400">28</div><div class="calendar-day text-gray-400">29</div><div class="calendar-day text-gray-400">30</div><div class="calendar-day">1</div><div class="calendar-day has-schedule" data-date="2">2 <span class="event-count">1</span></div><div class="calendar-day">3</div><div class="calendar-day">4</div>
                              <div class="calendar-day">5</div><div class="calendar-day">6</div><div class="calendar-day">7</div><div class="calendar-day">8</div><div class="calendar-day has-schedule" data-date="9">9 <span class="event-count">1</span></div><div class="calendar-day">10</div><div class="calendar-day">11</div>
                              <div class="calendar-day">12</div><div class="calendar-day">13</div><div class="calendar-day">14</div><div class="calendar-day">15</div><div class="calendar-day">16</div><div class="calendar-day has-schedule" data-date="17">17 <span class="event-count">2</span></div><div class="calendar-day">18</div>
                              <div class="calendar-day">19</div><div class="calendar-day">20</div><div class="calendar-day">21</div><div class="calendar-day">22</div><div class="calendar-day">23</div><div class="calendar-day">24</div><div class="calendar-day">25</div>
                              <div class="calendar-day">26</div><div class="calendar-day">27</div><div class="calendar-day">28</div><div class="calendar-day">29</div><div class="calendar-day">30</div><div class="calendar-day">31</div>
                        </div>
                    </div>
                    <!-- Kolom Detail Hari (UPDATED: STYLING) -->
                    <div class="lg:col-span-1 card">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4">Detail Perawatan</h2>
                        <p class="font-medium text-gray-700 mb-4" id="detail-tanggal">Pilih tanggal di kalender...</p>
                         <ul id="detail-list-ul" class="detail-item-list">
                            <li class="p-2 text-center text-gray-500">Pilih tanggal...</li>
                         </ul>
                    </div>
                </div>

                <!-- List Barang di Bawah (UPDATED: FILTER DURASI & PRIORITY) -->
                  <div class="card mt-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">List Semua Barang Perlu Perawatan</h2>
                    <!-- REVISI: Filter dipindahkan ke atas -->
                    <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4 p-4 bg-gray-50 rounded-lg border">
                        <div class="flex flex-wrap items-center gap-4 w-full">
                            <!-- Filter Durasi (Kiri) -->
                            <div class="flex-shrink-0">
                                <label for="filter-durasi" class="block text-sm font-medium text-gray-700 mb-1">Durasi</label>
                                <select id="filter-durasi" data-action="toggle-date-range" class="border border-gray-300 rounded-lg p-2 text-sm">
                                    <option value="all">Semua Durasi</option>
                                    <option value="1">1 Bulan</option>
                                    <option value="3">3 Bulan</option>
                                    <option value="6">6 Bulan</option>
                                </select>
                            </div>
                            <!-- Filter Satker -->
                            <div class="flex-shrink-0">
                                <label for="filter-satker-jadwal" class="block text-sm font-medium text-gray-700 mb-1">Satuan Kerja</label>
                                <select id="filter-satker-jadwal" class="border border-gray-300 rounded-lg p-2 text-sm">
                                    <option value="all">Semua Satker</option>
                                    <option value="AN">Administrasi Niaga</option>
                                    <option value="Elektro">Teknik Elektro</option>
                                    <option value="JTI">JTI</option>
                                </select>
                            </div>
                            <!-- Filter Tanggal (Akan di-toggle) -->
                            <div id="jadwal-tanggal-filter" class="flex flex-wrap items-center gap-2">
                                <div class="flex-shrink-0">
                                    <label for="tgl_mulai_jadwal" class="block text-sm font-medium text-gray-700 mb-1">Dari Tanggal</label>
                                    <input type="date" id="tgl_mulai_jadwal" class="border border-gray-300 rounded-lg p-2 text-sm">
                                </div>
                                <div class="flex-shrink-0">
                                    <label for="tgl_selesai_jadwal" class="block text-sm font-medium text-gray-700 mb-1">Sampai Tanggal</label>
                                    <input type="date" id="tgl_selesai_jadwal" class="border border-gray-300 rounded-lg p-2 text-sm">
                                </div>
                            </div>
                        </div>
                         <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64"> <!-- Search bar -->
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">ID Barang</th>
                                    <th class="p-4 font-semibold text-gray-600">Barang</th>
                                    <th class="p-4 font-semibold text-gray-600">Jadwal</th>
                                    <th class="p-4 font-semibold text-gray-600">Satker</th>
                                    <th class="p-4 font-semibold text-gray-600">Prioritas</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">BRG-001</td>
                                    <td class="p-4 text-gray-700">
                                         <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-001" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Komputer Apple Lab LSI 2</a>
                                     </td>
                                    <td class="p-4 text-gray-700">9 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">Administrasi Niaga</td>
                                    <td class="p-4"><span class="priority-tag priority-medium">Medium</span></td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">BRG-017</td>
                                    <td class="p-4 text-gray-700">
                                         <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-017" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Proyektor Ruang 712</a>
                                     </td>
                                    <td class="p-4 text-gray-700">17 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">Teknik Elektro</td>
                                    <td class="p-4"><span class="priority-tag priority-high">Tinggi</span></td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">BRG-002</td>
                                    <td class="p-4 text-gray-700">
                                         <a href="#detail-barang" data-target="#detail-barang" data-id="BRG-002" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Papan Tulis 7584</a>
                                     </td>
                                    <td class="p-4 text-gray-700">2 November 2025</td>
                                    <td class="p-4 text-gray-700">Teknik Elektro</td>
                                    <td class="p-4"><span class="priority-tag priority-low">Rendah</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: PENGAJUAN PERAWATAN ========= -->
            <div id="pengajuan-perawatan" class="page-content">
                 <div id="breadcrumb-pengajuan-perawatan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Form Pengajuan Perawatan</h1>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Form -->
                    <div class="lg:col-span-2 card">
                        <form class="space-y-4">
                            <div>
                                <label for="nama_pengajuan_pw" class="block text-sm font-medium text-gray-700 mb-1">Nama Pengajuan</label>
                                <input type="text" id="nama_pengajuan_pw" value="Pengajuan Triwulan JTI 2025" class="w-full border border-gray-300 rounded-lg p-2">
                            </div>
                            <div>
                                <label for="deskripsi_pengajuan_pw" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi Pengajuan (Opsional)</label>
                                <textarea id="deskripsi_pengajuan_pw" rows="3" class="w-full border border-gray-300 rounded-lg p-2" placeholder="Deskripsi umum..."></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="tanggal_pelaksanaan_pw" class="block text-sm font-medium text-gray-700 mb-1">Tanggal Pelaksanaan</label>
                                    <input type="date" id="tanggal_pelaksanaan_pw" value="2025-10-13" class="w-full border border-gray-300 rounded-lg p-2">
                                </div>
                                <div>
                                    <label for="nomor_proposal_pw" class="block text-sm font-medium text-gray-700 mb-1">Nomor Proposal/Surat</label>
                                    <input type="text" id="nomor_proposal_pw" value="KL/ADM-0923" class="w-full border border-gray-300 rounded-lg p-2">
                                </div>
                            </div>
                            <div>
                                <label for="satuan_kerja_pw" class="block text-sm font-medium text-gray-700 mb-1">Satuan Kerja (Satker)</label>
                                <select id="satuan_kerja_pw" class="w-full border border-gray-300 rounded-lg p-2">
                                    <option>Administrasi Niaga</option>
                                    <option>Teknik Elektro</option>
                                    <option>Teknik Sipil</option>
                                </select>
                            </div>
                            <div class="border border-gray-200 rounded-lg p-4 space-y-3">
                                <h3 class="font-semibold text-gray-800">Tambah Barang</h3>
                                <div>
                                    <label for="pilih_barang_pw" class="block text-sm font-medium text-gray-700 mb-1">Pilih Barang</label>
                                    <select id="pilih_barang_pw" class="w-full border border-gray-300 rounded-lg p-2">
                                        <option value="BRG-001" data-nama="Komputer Apple Lab LSI 2">BRG-001 - Komputer Apple Lab LSI 2</option>
                                        <option value="BRG-012" data-nama="Kursi Lab LSI 2">BRG-012 - Kursi Lab LSI 2</option>
                                        <option value="BRG-013" data-nama="Epson 12067">BRG-013 - Epson 12067</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="deskripsi_barang_pw" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi Kondisi Barang</label>
                                    <textarea id="deskripsi_barang_pw" rows="2" class="w-full border border-gray-300 rounded-lg p-2" placeholder="cth: Perlu dibersihkan, debu tebal..."></textarea>
                                </div>
                                <button type="button" id="tambah-barang-btn-pw" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2 w-full justify-center">
                                    <i class="fas fa-plus"></i><span>Tambahkan Barang ke List</span></button>
                            </div>
                        </form>
                    </div>
                    <!-- Kolom Tabel Barang -->
                    <div class="lg:col-span-1 card">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4">Barang yang Diajukan</h2>
                        <ul id="list-barang-diajukan-pw" class="space-y-3">
                            <li class="p-3 border rounded-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="font-medium text-gray-800">Epson 13124</p>
                                        <p class="text-sm text-gray-600 italic mt-1">"Perlu pembersihan head"</p>
                                    </div>
                                    <button class="text-red-500 hover:text-red-700 ml-2 remove-barang-btn"><i class="fas fa-trash"></i></button>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- Tombol Aksi Form -->
                <div class="flex flex-wrap justify-end gap-3 mt-6">
                    <button type="button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg">Cancel</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg">Ajukan Perawatan</button>
                </div>
            </div>

            <!-- ========= HALAMAN: RIWAYAT PENGAJUAN PERAWATAN ========= -->
            <div id="riwayat-pengajuan-perawatan" class="page-content">
                 <div id="breadcrumb-riwayat-pengajuan-perawatan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Riwayat Pengajuan Perawatan</h1>
                <div class="card">
                    <!-- Header Card -->
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <div class="flex flex-wrap items-center gap-2">
                            <select class="border border-gray-300 rounded-lg p-2">
                                <option>Filter Status</option>
                                <option>Menunggu Persetujuan</option>
                                <option>Disetujui</option>
                                <option>Ditolak</option>
                                <option>Selesai</option>
                            </select>
                            <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                        </div>
                    </div>
                    <!-- Tabel Data -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">ID Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Tanggal</th>
                                    <th class="p-4 font-semibold text-gray-600">Status</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                 <tr> <!-- CONTOH DITOLAK -->
                                    <td class="p-4 text-gray-700">SIPL-01326</td>
                                    <td class="p-4 text-gray-700">Pengecatan Ruang Kelas Sipil</td>
                                    <td class="p-4 text-gray-700">15 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-red-100 text-red-700 text-xs font-medium px-2 py-1 rounded-full">Ditolak</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <!-- Atur data-status agar JS tahu ini ditolak -->
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perawatan" data-id="SIPL-01326" data-status="ditolak">Detail</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">JTI-01324</td>
                                    <td class="p-4 text-gray-700">Pengajuan Triwulan JTI 2025</td>
                                    <td class="p-4 text-gray-700">10 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-yellow-100 text-yellow-700 text-xs font-medium px-2 py-1 rounded-full">Menunggu Persetujuan</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perawatan" data-id="JTI-01324" data-status="menunggu">Detail</button>
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">AN-01325</td>
                                    <td class="p-4 text-gray-700">Perbaikan Kursi AN 2025</td>
                                    <td class="p-4 text-gray-700">9 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Disetujui</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perawatan" data-id="AN-01325" data-status="disetujui">Detail</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: DETAIL RIWAYAT PENGAJUAN PERAWATAN (UPDATED: REASON DITOLAK) ========= -->
            <div id="detail-riwayat-perawatan" class="page-content">
                 <div id="breadcrumb-detail-riwayat-perawatan" class="breadcrumbs"></div>
                <h1 id="detail-title-perawatan" class="text-3xl font-bold text-gray-800 mb-6">Detail Pengajuan Perawatan</h1>

                <!-- Container Tombol Aksi Admin -->
                <div id="admin-actions-perawatan" class="admin-action-buttons mb-4 hidden">
                         <button class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-check"></i><span>Setujui Pengajuan</span></button>
                         <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2" id="btn-tolak-perawatan"><i class="fas fa-times"></i><span>Tolak Pengajuan</span></button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Detail & Barang -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Card Detail -->
                        <div class="card">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-info-circle text-blue-600"></i>Informasi Pengajuan</h2>
                            <div id="detail-info-perawatan" class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                                <!-- JS will populate this based on data-id -->
                                <p class="col-span-2 text-gray-500">Memuat data...</p>
                            </div>
                            <!-- CATATAN PENOLAKAN (BARU) -->
                            <div id="catatan-penolakan-perawatan" class="mt-6 p-4 bg-red-50 border-l-4 border-red-500 rounded hidden">
                                <h3 class="font-semibold text-red-700 mb-2 flex items-center gap-2"><i class="fas fa-ban"></i>Alasan Penolakan</h3>
                                <p id="alasan-penolakan-text-perawatan" class="text-sm text-red-600 italic">Anggaran belum tersedia untuk pengecatan saat ini.</p>
                            </div>
                        </div>

                        <!-- Card Daftar Barang -->
                        <div id="detail-barang-card-perawatan" class="card">
                               <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-clipboard-list text-blue-600"></i>Daftar Barang (Verifikasi)</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                     <thead class="bg-gray-50 border-b border-gray-200">
                                         <tr>
                                             <th class="p-3 font-semibold text-gray-600"><input type="checkbox" class="rounded border-gray-300"></th>
                                             <th class="p-3 font-semibold text-gray-600">ID Barang</th>
                                             <th class="p-3 font-semibold text-gray-600">Nama Barang</th>
                                             <th class="p-3 font-semibold text-gray-600">Deskripsi Kondisi</th>
                                             <th class="p-3 font-semibold text-gray-600 text-center">Aksi</th>
                                         </tr>
                                     </thead>
                                     <tbody id="detail-barang-table-perawatan" class="divide-y divide-gray-200">
                                         <!-- JS will populate this -->
                                         <tr><td colspan="5" class="p-4 text-center text-gray-500">Memuat data...</td></tr>
                                     </tbody>
                                </table>
                            </div>
                              <button id="verifikasi-btn-perawatan" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg w-full mt-4 hidden">Verifikasi Barang Terpilih</button>
                        </div>
                    </div>

                    <!-- Kolom Timeline -->
                    <div class="lg:col-span-1">
                        <div class="card">
                               <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3"><i class="fas fa-stream text-blue-600"></i>Timeline</h2>
                            <div id="detail-timeline-perawatan" class="mb-6">
                                <!-- JS will populate this -->
                                <p class="text-gray-500">Memuat timeline...</p>
                            </div>
                            <!-- Catatan Tambahan -->
                             <div class="border-t pt-4">
                                 <h3 class="font-semibold text-gray-800 mb-2 flex items-center gap-2"><i class="fas fa-sticky-note text-blue-600"></i>Catatan Tambahan</h3>
                                 <!-- Contoh Catatan Tersimpan -->
                                 <div id="catatan-tersimpan-perawatan" class="mb-3 space-y-2">
                                     <div class="bg-gray-100 p-2 rounded text-sm text-gray-700">
                                         <p class="font-medium">Admin UPA (11 Okt 2025):</p>
                                         <p>Mohon segera diproses.</p>
                                     </div>
                                     <!-- JS will add more notes here if available -->
                                 </div>
                                 <textarea id="textarea-catatan-perawatan" rows="3" class="w-full border border-gray-300 rounded-lg p-2 text-sm" placeholder="Tambahkan catatan..."></textarea>
                                 <button class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-1 px-3 rounded-lg mt-2">Simpan Catatan</button>
                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: RIWAYAT PELAKSANAAN PERAWATAN ========= -->
            <div id="riwayat-pelaksanaan-perawatan" class="page-content">
                 <div id="breadcrumb-riwayat-pelaksanaan-perawatan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Riwayat Pelaksanaan Perawatan</h1>
                <div class="card">
                    <p class="mb-4">Halaman ini menampilkan daftar pengajuan yang telah selesai dilaksanakan.</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">ID Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Tgl Selesai</th>
                                    <th class="p-4 font-semibold text-gray-600">Status</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">AN-01325</td>
                                    <td class="p-4 text-gray-700">Perbaikan Kursi AN 2025</td>
                                    <td class="p-4 text-gray-700">12 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Selesai</span>
                                     </td>
                                    <td class="p-4 flex gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perawatan" data-id="AN-01325" data-status="selesai">Detail</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: PENGAJUAN PERBAIKAN ========= -->
            <div id="pengajuan-perbaikan" class="page-content">
                 <div id="breadcrumb-pengajuan-perbaikan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Form Pengajuan Perbaikan</h1>
                <p class="mb-4 text-gray-600">Form ini khusus untuk perbaikan insidentil (tanpa jadwal).</p>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Form -->
                    <div class="lg:col-span-2 card">
                        <form class="space-y-4">
                            <div>
                                <label for="nama_pengajuan_pb" class="block text-sm font-medium text-gray-700 mb-1">Nama Pengajuan</label>
                                <input type="text" id="nama_pengajuan_pb" placeholder="cth: Perbaikan AC Ruang 712" class="w-full border border-gray-300 rounded-lg p-2">
                            </div>
                            <div>
                                <label for="deskripsi_pengajuan_pb" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi Pengajuan (Opsional)</label>
                                <textarea id="deskripsi_pengajuan_pb" rows="3" class="w-full border border-gray-300 rounded-lg p-2" placeholder="Deskripsi umum..."></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="tanggal_pelaksanaan_pb" class="block text-sm font-medium text-gray-700 mb-1">Tanggal Pengajuan</label>
                                    <input type="date" id="tanggal_pelaksanaan_pb" class="w-full border border-gray-300 rounded-lg p-2">
                                </div>
                                <div>
                                    <label for="nomor_proposal_pb" class="block text-sm font-medium text-gray-700 mb-1">Nomor Surat (Jika Ada)</label>
                                    <!-- Input Group dengan Tombol Generate -->
                                    <div class="flex items-center">
                                        <input type="text" id="nomor_proposal_pb" class="w-full border border-gray-300 rounded-l-lg p-2 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500">
                                        <button type="button" id="generate-nomor-surat-pb" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-r-lg flex items-center gap-1 text-sm whitespace-nowrap">
                                             <i class="fas fa-sync-alt"></i> Auto
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="satuan_kerja_pb" class="block text-sm font-medium text-gray-700 mb-1">Satuan Kerja (Satker)</label>
                                <select id="satuan_kerja_pb" class="w-full border border-gray-300 rounded-lg p-2">
                                    <option>Administrasi Niaga</option>
                                    <option>Teknik Elektro</option>
                                    <option>Teknik Sipil</option>
                                </select>
                            </div>
                            <div class="border border-gray-200 rounded-lg p-4 space-y-3">
                                <h3 class="font-semibold text-gray-800">Tambah Barang Rusak</h3>
                                <div>
                                    <label for="pilih_barang_pb" class="block text-sm font-medium text-gray-700 mb-1">Pilih Barang</label>
                                    <select id="pilih_barang_pb" class="w-full border border-gray-300 rounded-lg p-2">
                                        <option value="BRG-001" data-nama="Komputer Apple Lab LSI 2">BRG-001 - Komputer Apple Lab LSI 2</option>
                                        <option value="BRG-017" data-nama="Proyektor Ruang 712">BRG-017 - Proyektor Ruang 712</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="deskripsi_barang_pb" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi Kerusakan</label>
                                    <textarea id="deskripsi_barang_pb" rows="2" class="w-full border border-gray-300 rounded-lg p-2" placeholder="cth: Mati total, gambar buram..."></textarea>
                                </div>
                                <button type="button" id="tambah-barang-btn-pb" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2 w-full justify-center">
                                     <i class="fas fa-plus"></i>
                                    <span>Tambahkan Barang</span>
                                </button>
                            </div>
                        </form>
                    </div>
                    <!-- Kolom Tabel Barang (DENGAN CONTOH) -->
                    <div class="lg:col-span-1 card">
                        <h2 class="text-xl font-semibold text-gray-800 mb-4">Barang yang Diajukan</h2>
                        <ul id="list-barang-diajukan-pb" class="space-y-3">
                            <li class="p-3 border rounded-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="font-medium text-gray-800">Proyektor Ruang 712</p>
                                        <p class="text-sm text-gray-600 italic mt-1">"Gambar buram dan bergaris."</p>
                                    </div>
                                    <button type="button" class="text-red-500 hover:text-red-700 ml-2 remove-barang-btn"><i class="fas fa-trash"></i></button>
                                </div>
                            </li>
                            <!-- JS akan mengisi sisanya -->
                        </ul>
                    </div>
                </div>
                <div class="flex flex-wrap justify-end gap-3 mt-6">
                    <button type="button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-6 rounded-lg">Cancel</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg">Ajukan Perbaikan</button>
                </div>
            </div>

            <!-- ========= HALAMAN: RIWAYAT PENGAJUAN PERBAIKAN ========= -->
            <div id="riwayat-pengajuan-perbaikan" class="page-content">
                 <div id="breadcrumb-riwayat-pengajuan-perbaikan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Riwayat Pengajuan Perbaikan</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <div class="flex flex-wrap items-center gap-2">
                            <select class="border border-gray-300 rounded-lg p-2">
                                <option>Filter Status</option>
                                <option>Menunggu Persetujuan</option>
                                <option>Disetujui</option>
                                <option>Ditolak</option>
                                <option>Selesai</option>
                            </select>
                            <input type="text" placeholder="Search..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">ID Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Tanggal</th>
                                    <th class="p-4 font-semibold text-gray-600">Status</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">PBK-002</td>
                                    <td class="p-4 text-gray-700">Perbaikan Pintu Lab Jaringan</td>
                                    <td class="p-4 text-gray-700">25 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-blue-100 text-blue-700 text-xs font-medium px-2 py-1 rounded-full">Sedang Dikerjakan</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perbaikan" data-id="PBK-002" data-status="dikerjakan">Detail</button>
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">PBK-001</td>
                                    <td class="p-4 text-gray-700">Perbaikan AC Ruang 712</td>
                                    <td class="p-4 text-gray-700">11 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Selesai</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perbaikan" data-id="PBK-001" data-status="selesai">Detail</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: RIWAYAT PELAKSANAAN PERBAIKAN ========= -->
            <div id="riwayat-pelaksanaan-perbaikan" class="page-content">
                 <div id="breadcrumb-riwayat-pelaksanaan-perbaikan" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Riwayat Pelaksanaan Perbaikan</h1>
                 <div class="card">
                    <p class="mb-4">Halaman ini menampilkan daftar perbaikan yang telah selesai dilaksanakan.</p>
                     <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">ID Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Pengajuan</th>
                                    <th class="p-4 font-semibold text-gray-600">Tgl Selesai</th>
                                    <th class="p-4 font-semibold text-gray-600">Status</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">PBK-001</td>
                                    <td class="p-4 text-gray-700">Perbaikan AC Ruang 712</td>
                                    <td class="p-4 text-gray-700">13 Oktober 2025</td>
                                    <td class="p-4 text-gray-700">
                                         <span class="bg-green-100 text-green-700 text-xs font-medium px-2 py-1 rounded-full">Selesai</span>
                                     </td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-1 px-3 rounded-lg menu-link detail-link" data-target="#detail-riwayat-perbaikan" data-id="PBK-001" data-status="selesai">Detail</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: DETAIL RIWAYAT PERBAIKAN (UPDATED: REASON DITOLAK) ========= -->
            <div id="detail-riwayat-perbaikan" class="page-content">
                 <div id="breadcrumb-detail-riwayat-perbaikan" class="breadcrumbs"></div>
                 <h1 id="detail-title-perbaikan" class="text-3xl font-bold text-gray-800 mb-6">Detail Pengajuan Perbaikan</h1>

                 <!-- Container Tombol Aksi Admin -->
                 <div id="admin-actions-perbaikan" class="admin-action-buttons mb-4 hidden">
                         <button class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-check"></i><span>Setujui Pengajuan</span></button>
                         <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2" id="btn-tolak-perbaikan"><i class="fas fa-times"></i><span>Tolak Pengajuan</span></button>
                 </div>


                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Detail & Barang -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Card Detail -->
                        <div class="card">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-info-circle text-blue-600"></i>Informasi Pengajuan</h2>
                             <div id="detail-info-perbaikan" class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                                <!-- JS will populate this -->
                                <p class="col-span-2 text-gray-500">Memuat data...</p>
                            </div>
                            <!-- CATATAN PENOLAKAN (BARU) -->
                            <div id="catatan-penolakan-perbaikan" class="mt-6 p-4 bg-red-50 border-l-4 border-red-500 rounded hidden">
                                <h3 class="font-semibold text-red-700 mb-2 flex items-center gap-2"><i class="fas fa-ban"></i>Alasan Penolakan</h3>
                                <p id="alasan-penolakan-text-perbaikan" class="text-sm text-red-600 italic"></p>
                            </div>
                        </div>

                        <!-- Card Daftar Barang -->
                        <div id="detail-barang-card-perbaikan" class="card">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-clipboard-list text-blue-600"></i>Daftar Barang (Verifikasi)</h2>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                     <thead class="bg-gray-50 border-b border-gray-200">
                                         <tr>
                                             <th class="p-3 font-semibold text-gray-600"><input type="checkbox" class="rounded border-gray-300"></th>
                                             <th class="p-3 font-semibold text-gray-600">ID Barang</th>
                                             <th class="p-3 font-semibold text-gray-600">Nama Barang</th>
                                             <th class="p-3 font-semibold text-gray-600">Deskripsi Kondisi</th>
                                             <th class="p-3 font-semibold text-gray-600 text-center">Aksi</th>
                                         </tr>
                                     </thead>
                                      <tbody id="detail-barang-table-perbaikan" class="divide-y divide-gray-200">
                                         <!-- JS will populate this -->
                                         <tr><td colspan="5" class="p-4 text-center text-gray-500">Memuat data...</td></tr>
                                     </tbody>
                                </table>
                            </div>
                               <button id="verifikasi-btn-perbaikan" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg w-full mt-4 hidden">Verifikasi Barang Terpilih</button>
                        </div>
                    </div>

                    <!-- Kolom Timeline -->
                    <div class="lg:col-span-1">
                        <div class="card">
                               <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center gap-3"><i class="fas fa-stream text-blue-600"></i>Timeline</h2>
                               <div id="detail-timeline-perbaikan" class="mb-6">
                                <!-- JS will populate this -->
                                <p class="text-gray-500">Memuat timeline...</p>
                            </div>
                              <!-- Catatan Tambahan -->
                               <div class="border-t pt-4">
                                 <h3 class="font-semibold text-gray-800 mb-2 flex items-center gap-2"><i class="fas fa-sticky-note text-blue-600"></i>Catatan Tambahan</h3>
                                 <div id="catatan-tersimpan-perbaikan" class="mb-3 space-y-2">
                                     <!-- JS will add notes here if available -->
                                 </div>
                                 <textarea id="textarea-catatan-perbaikan" rows="3" class="w-full border border-gray-300 rounded-lg p-2 text-sm" placeholder="Tambahkan catatan..."></textarea>
                                 <button class="bg-blue-500 hover:bg-blue-600 text-white text-sm font-medium py-1 px-3 rounded-lg mt-2">Simpan Catatan</button>
                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: MASTER USER ========= -->
            <div id="master-user" class="page-content">
                 <div id="breadcrumb-master-user" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Master User</h1>
                <div class="card">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah User</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                        <input type="text" placeholder="Search user..." class="border border-gray-300 rounded-lg p-2 w-full sm:w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama</th>
                                    <th class="p-4 font-semibold text-gray-600">Username</th>
                                    <th class="p-4 font-semibold text-gray-600">Hak Akses</th>
                                    <th class="p-4 font-semibold text-gray-600">Satker</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">Admin UPA</td> <!-- Nama diubah -->
                                    <td class="p-4 text-gray-700">admin_upa</td> <!-- Username diubah -->
                                    <td class="p-4 text-gray-700">Admin</td> <!-- Hak Akses diubah -->
                                    <td class="p-4 text-gray-700">UPA PP</td> <!-- Satker diubah -->
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">Teknisi JTI</td>
                                    <td class="p-4 text-gray-700">teknisi_jti</td>
                                    <td class="p-4 text-gray-700">Teknisi</td>
                                    <td class="p-4 text-gray-700">JTI</td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- ========= HALAMAN: MASTER ROLE (BARU) ========= -->
            <div id="master-role" class="page-content">
            <div id="breadcrumb-master-role" class="breadcrumbs"></div>
            <h1 class="text-3xl font-bold text-gray-800 mb-6">Master Role (Permission Management)</h1>
            <div class="card">
                <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah Role Baru</span></button>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead class="bg-gray-50 border-b border-gray-200">
                            <tr>
                                <th class="p-4 font-semibold text-gray-600">Role Name</th>
                                
                                <th class="p-4 font-semibold text-gray-600 w-1/3">Aksi</th>
                            </tr>
                        </thead>
                       <tbody class="divide-y divide-gray-200">
                        <tr>
                            <td class="p-4 text-gray-700 font-normal">Admin UPA</td>
                            <td class="p-4 flex flex-wrap gap-2">
                                <a href="#edit-hak-akses" 
                                class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded-lg flex items-center gap-1 menu-link" 
                                data-role-name="Admin UPA" 
                                data-breadcrumb="User & Hak Akses<span>/</span>Master Role<span>/</span>Edit Hak Akses">
                                    <i class="fas fa-cog"></i><span>Atur Hak Akses</span>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td class="p-4 text-gray-700 font-normal">Teknisi</td>
                            <td class="p-4 flex flex-wrap gap-2">
                                <a href="#edit-hak-akses" 
                                class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded-lg flex items-center gap-1 menu-link" 
                                data-role-name="Teknisi"
                                data-breadcrumb="User & Hak Akses<span>/</span>Master Role<span>/</span>Edit Hak Akses">
                                    <i class="fas fa-cog"></i><span>Atur Hak Akses</span>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td class="p-4 text-gray-700 font-normal">User Satker</td>
                            <td class="p-4 flex flex-wrap gap-2">
                                <a href="#edit-hak-akses" 
                                class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded-lg flex items-center gap-1 menu-link" 
                                data-role-name="User Satker"
                                data-breadcrumb="User & Hak Akses<span>/</span>Master Role<span>/</span>Edit Hak Akses">
                                    <i class="fas fa-cog"></i><span>Atur Hak Akses</span>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                    </table>
                </div>
            </div>
        </div>

            <!-- ========= HALAMAN: MASTER HAK AKSES (LAMA) ========= -->
            <div id="master-hak-akses" class="page-content">
                 <div id="breadcrumb-master-hak-akses" class="breadcrumbs"></div>
                <h1 class="text-3xl font-bold text-gray-800 mb-6">Master Hak Akses (Lama)</h1>
                <div class="card">
                    <p class="mb-4 text-gray-600">Halaman ini adalah versi lama. Silakan gunakan <strong>Master Role</strong> untuk manajemen permission yang lebih detail.</p>
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div class="flex flex-wrap gap-2">
                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-plus"></i><span>Tambah Hak Akses</span></button>
                            <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-import"></i><span>Import</span></button>
                            <button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2"><i class="fas fa-file-export"></i><span>Export</span></button>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 border-b border-gray-200">
                                <tr>
                                    <th class="p-4 font-semibold text-gray-600">No</th>
                                    <th class="p-4 font-semibold text-gray-600">Nama Hak Akses</th>
                                    <th class="p-4 font-semibold text-gray-600">Deskripsi</th>
                                    <th class="p-4 font-semibold text-gray-600">Aksi</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200">
                                <tr>
                                    <td class="p-4 text-gray-700">1</td>
                                    <td class="p-4 text-gray-700">Admin</td>
                                    <td class="p-4 text-gray-700">Akses penuh ke semua modul</td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">2</td>
                                    <td class="p-4 text-gray-700">Teknisi</td>
                                    <td class="p-4 text-gray-700">Hanya bisa melihat jadwal dan mengisi laporan pelaksanaan</td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="p-4 text-gray-700">3</td>
                                    <td class="p-4 text-gray-700">User Satker</td>
                                    <td class="p-4 text-gray-700">Hanya bisa mengajukan perawatan/perbaikan</td>
                                    <td class="p-4 flex flex-wrap gap-2">
                                        <button class="bg-yellow-400 hover:bg-yellow-500 text-white font-medium py-1 px-3 rounded-lg">Edit</button>
                                        <button class="bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-lg">Hapus</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ========= HALAMAN: DETAIL BARANG ========= -->
            <div id="detail-barang" class="page-content">
                 <div id="breadcrumb-detail-barang" class="breadcrumbs"></div>
                <!-- Judul diupdate oleh JS -->
                <h1 id="detail-barang-title" class="text-3xl font-bold text-gray-800 mb-6">Detail Barang</h1>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Informasi Barang -->
                    <div class="lg:col-span-1 card h-fit">
                         <h2 class="text-xl font-semibold text-gray-800 mb-6 border-b pb-2">Informasi Barang</h2>
                         <div id="detail-barang-info" class="space-y-4">
                            <!-- JS will populate this -->
                            <p class="text-gray-500">Memuat data...</p>
                        </div>
                        <div class="mt-6">
                             <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2 w-full justify-center">
                                <i class="fas fa-qrcode"></i><span>Download QR Code</span>
                             </button>
                        </div>
                    </div>

                    <!-- Kolom Riwayat & Jadwal -->
                    <div class="lg:col-span-2 space-y-6">
                        <!-- Card Riwayat -->
                        <div class="card">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-history text-blue-600"></i>Riwayat Perawatan & Perbaikan</h2>
                             <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                     <thead class="bg-gray-50 border-b border-gray-200">
                                         <tr>
                                             <th class="p-3 font-semibold text-gray-600">Tanggal</th>
                                             <th class="p-3 font-semibold text-gray-600">Jenis</th>
                                             <th class="p-3 font-semibold text-gray-600">Deskripsi</th>
                                             <th class="p-3 font-semibold text-gray-600">Status</th>
                                             <th class="p-3 font-semibold text-gray-600 text-center">Aksi</th> <!-- Kolom Aksi Baru -->
                                         </tr>
                                     </thead>
                                     <tbody id="detail-barang-riwayat" class="divide-y divide-gray-200">
                                         <!-- JS will populate this -->
                                         <tr><td colspan="5" class="p-4 text-center text-gray-500">Memuat riwayat...</td></tr>
                                     </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Card Jadwal -->
                          <div class="card">
                            <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-3"><i class="fas fa-calendar-check text-blue-600"></i>Jadwal Perawatan Berikutnya</h2>
                            <div id="detail-barang-jadwal">
                                <!-- JS will populate this -->
                                <p class="text-gray-500">Memuat jadwal...</p>
                            </div>
                           </div>
                    </div>
                </div>
            </div>

 <!-- MODAL HAK AKSES (BARU) -->
    <div id="edit-hak-akses" class="page-content">
    <div id="breadcrumb-edit-hak-akses" class="breadcrumbs"></div>
    
    <h1 id="edit-hak-akses-title" class="text-3xl font-bold text-gray-800 mb-6">Atur Hak Akses</h1>

    <div class="card">
        <p class="text-sm text-gray-600 bg-gray-50 p-3 rounded-lg mb-6">Centang hak akses yang diizinkan untuk Role ini.</p>
        
        <div id="permission-list-page" class="space-y-6">
            <p class="text-gray-500">Memuat...</p>
        </div>
    </div>

    <div class="flex justify-end gap-3 mt-6">
        <button class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg menu-link" href="#master-role" data-breadcrumb="User & Hak Akses<span>/</span>Master Role">
            Batal
        </button>
        <button id="save-hak-akses-page" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg">
            Simpan Perubahan
        </button>
    </div>
</div>

        </div> <!-- End .page-container -->
    </div> <!-- End .main-content -->
    
   
    
    <!-- MODAL IMPRT BARANG (LAMA) -->
    <div id="import-barang-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg transform transition-all duration-300 scale-100">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800"><i class="fas fa-file-import mr-2 text-blue-600"></i> Import Master Barang</h3>
                <button id="close-import-modal" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times fa-lg"></i>
                </button>
            </div>
            
            <div class="p-6 space-y-5">
                <div class="flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="font-medium text-blue-800">Unduh Template Import (.xlsx)</p>
                    <button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center gap-2 text-sm" onclick="alert('Downloading Template...')">
                         <i class="fas fa-download"></i><span>Download</span>
                    </button>
                </div>
                
                <div id="drop-zone-barang" class="border-2 border-dashed border-gray-300 p-8 text-center rounded-lg cursor-pointer hover:border-blue-500 transition duration-150">
                    <i class="fas fa-cloud-upload-alt fa-3x text-gray-400 mb-3"></i>
                    <p class="text-gray-600 font-medium">Drag & Drop file CSV/Excel di sini</p>
                    <p class="text-sm text-gray-500">atau</p>
                    <input type="file" id="import-file-input" class="hidden" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel">
                    <button type="button" class="mt-3 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg text-sm" onclick="document.getElementById('import-file-input').click()">
                        Pilih File dari Komputer
                    </button>
                </div>
                
                <p id="file-status-barang" class="text-sm text-gray-500 italic mt-2">Belum ada file dipilih.</p>
            </div>
            
            <div class="p-4 border-t flex justify-end gap-3">
                <button id="cancel-import-barang" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg">Batal</button>
                <button id="submit-import-barang" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg disabled:opacity-50" disabled>
                    Proses Import
                </button>
            </div>
        </div>
    </div>
    
    <!-- MODAL TOLAK (BARU) -->
    <div id="modal-tolak-pengajuan" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800"><i class="fas fa-times-circle mr-2 text-red-600"></i> Tolak Pengajuan</h3>
                <button id="close-modal-tolak" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times fa-lg"></i>
                </button>
            </div>
            
            <div class="p-6 space-y-4">
                <p class="text-gray-700">Tuliskan **alasan penolakan** secara singkat. Alasan ini akan tercatat di detail pengajuan.</p>
                <textarea id="alasan-tolak-input" rows="4" class="w-full border border-gray-300 rounded-lg p-2" placeholder="Contoh: Anggaran belum tersedia, pengajuan tidak lengkap, dll."></textarea>
            </div>
            
            <div class="p-4 border-t flex justify-end gap-3">
                <button id="cancel-modal-tolak" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg">Batal</button>
                <button id="submit-modal-tolak" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg">
                    Konfirmasi Tolak
                </button>
            </div>
        </div>
    </div>


    <script>
        
        document.addEventListener('DOMContentLoaded', function() {
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
            const allMenuLinks = document.querySelectorAll('.menu-link');
            const allPages = document.querySelectorAll('.page-content');

            // --- Elemen untuk Responsive Sidebar ---
            const sidebar = document.getElementById('sidebar');
            const menuToggleBtn = document.getElementById('menu-toggle');
            const sidebarOverlay = document.getElementById('sidebar-overlay');

            // --- Data Mockup untuk Chart Dinamis ---
            const chartData = {
                "2025": [60, 40, 80, 50, 90, 30], // Jun - Nov
                "2024": [55, 45, 70, 60, 85, 35],
                "2023": [50, 50, 65, 55, 75, 40]
            };
            const chartLabels = ["Jun", "Jul", "Agt", "Sep", "Okt", "Nov"];
            const chartContainer = document.getElementById('chart-container');
            const chartYearSelect = document.getElementById('chart-year-select');

            // --- Data Mockup untuk Jadwal Kalender ---
            const scheduleData = {
                "2": [{ id: "BRG-00X", barang: "Pengecekan AC", satker: "Umum", priority: "low" }],
                "9": [{ id: "BRG-001", barang: "Komputer Apple", satker: "AN", priority: "medium" }],
                "17": [ 
                    { id: "BRG-017", barang: "Proyektor 712", satker: "Elektro", priority: "high" }, 
                    { id: "BRG-01X", barang: "Speaker 712", satker: "Elektro", priority: "medium" } 
                ]
            };
            
            // --- Fungsi untuk Mengupdate Chart ---
            function updateChart(year) {
                const data = chartData[year] || chartData["2025"]; // Default ke 2025 jika tahun tidak valid
                chartContainer.innerHTML = `
                     <span class="y-axis-label y-axis-label-low">0</span>
                     <span class="y-axis-label y-axis-label-mid">50</span>
                     <span class="y-axis-label y-axis-label-high">100</span>
                `; // Reset container + labels

                data.forEach((value, index) => {
                    const bar = document.createElement('div');
                    bar.className = 'chart-bar';
                    bar.style.height = '0%'; // Start from 0 for animation
                    bar.innerHTML = `<span class="value">${value}</span><span class="label">${chartLabels[index]}</span>`;
                    chartContainer.appendChild(bar);

                    // Animate height and show value
                    setTimeout(() => {
                        bar.style.height = `${value}%`;
                        bar.classList.add('show-value');
                    }, 100 + index * 50); // Stagger animation
                });
            }

            // --- Event Listener untuk Dropdown Tahun Chart ---
            if (chartYearSelect) {
                chartYearSelect.addEventListener('change', function() {
                    updateChart(this.value);
                });
            }

            // --- Chart Initialization (show values for default year) ---
            updateChart(chartYearSelect ? chartYearSelect.value : "2025");


            // --- FUNGSI RESPONSIVE SIDEBAR ---
            if (menuToggleBtn) {
                menuToggleBtn.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                    sidebarOverlay.classList.toggle('hidden');
                });
            }

            if (sidebarOverlay) {
                sidebarOverlay.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                    sidebarOverlay.classList.add('hidden');
                });
            }


            // --- FUNGSI NAVIGASI HALAMAN, BREADCRUMB, & LINK AKTIF ---
            function showPage(targetId, breadcrumbHtml) {
                allPages.forEach(page => {
                    page.classList.remove('active');
                });

                const targetPage = document.querySelector(targetId);
                if (targetPage) {
                    targetPage.classList.add('active');
                    // Update breadcrumb untuk halaman yang baru aktif
                    const breadcrumbContainer = targetPage.querySelector('.breadcrumbs');
                    if (breadcrumbContainer) {
                         breadcrumbContainer.innerHTML = breadcrumbHtml || 'Dashboard';
                    }
                    document.querySelector('.page-container').scrollTop = 0; // Scroll ke atas
                } else {
                    console.warn(`Target page ${targetId} not found. Showing dashboard.`);
                    document.querySelector('#dashboard').classList.add('active');
                     document.querySelector('#breadcrumb-dashboard').innerHTML = 'Dashboard'; // Update breadcrumb default
                }
            }

            allMenuLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href') || this.dataset.target;
                    const breadcrumbData = this.dataset.breadcrumb;

                    if (!this.classList.contains('dropdown-toggle')) {
                        e.preventDefault();

                        if (targetId && targetId.startsWith('#')) {
                            showPage(targetId, breadcrumbData);

                             // --- LOGIKA KHUSUS UNTUK DETAIL PAGES ---
                           if (targetId === '#detail-riwayat-perawatan' || targetId === '#detail-riwayat-perbaikan') {
                loadDetailPengajuan(this.dataset.id, this.dataset.status, targetId.includes('perawatan'));
              } else if (targetId === '#detail-barang') {
                loadDetailBarang(this.dataset.id);
              } else if (targetId === '#edit-hak-akses') {
                                // Panggil fungsi pemuat halaman hak akses baru
                                const roleName = this.dataset.roleName;
                                if (roleName) {
                                    loadHakAksesPage(roleName);
                                } else {
                                    console.error("Role name tidak ditemukan (data-role-name)");
                                }
                            }
            }

            if (window.innerWidth < 768) {
                             if (sidebar && sidebarOverlay) {
                                 sidebar.classList.remove('active');
                                 sidebarOverlay.classList.add('hidden');
                             }
                        }

                    } else {
                        // Prevent default only for dropdown toggles
                        e.preventDefault();
                    }

                    // Update Active Link Styling
                    allMenuLinks.forEach(l => l.classList.remove('active-link'));
                    this.classList.add('active-link');

                    // Highlight parent if it's a sub-menu link
                    let parentMenu = this.closest('.sub-menu');
                    if (parentMenu) {
                        let parentToggle = parentMenu.previousElementSibling;
                        if(parentToggle && parentToggle.classList.contains('dropdown-toggle')) {
                            parentToggle.classList.add('active-link');
                        }
                    } else if (this.classList.contains('dropdown-toggle')) {
                        this.classList.add('active-link');
                    }
                });
            });

            // --- FUNGSI ACCORDION DROPDOWN ---
            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();

                    const currentSubMenu = this.nextElementSibling;
                    const wasActive = currentSubMenu.style.maxHeight && currentSubMenu.style.maxHeight !== '0px';

                    // Close other sub-menus first
                    document.querySelectorAll('.sub-menu').forEach(subMenu => {
                         if (subMenu !== currentSubMenu) {
                             subMenu.style.maxHeight = null;
                             const siblingToggle = subMenu.previousElementSibling;
                             if (siblingToggle && siblingToggle.classList.contains('dropdown-toggle')) {
                                 siblingToggle.classList.remove('dropdown-active');
                             }
                         }
                    });

                    if (!wasActive) {
                        currentSubMenu.style.maxHeight = currentSubMenu.scrollHeight + "px";
                        this.classList.add('dropdown-active');
                    } else {
                        currentSubMenu.style.maxHeight = null;
                         this.classList.remove('dropdown-active');
                    }
                });
            });

             // --- LOGIKA MOCKUP FORM PENGAJUAN (Perawatan & Perbaikan) ---
             function setupPengajuanForm(formType) {
                 const tambahBtnId = `#tambah-barang-btn-${formType}`;
                 const barangSelectId = `#pilih_barang_${formType}`;
                 const deskripsiTextareaId = `#deskripsi_barang_${formType}`;
                 const listUlId = `#list-barang-diajukan-${formType}`;

                 const tambahBarangBtn = document.querySelector(tambahBtnId);
                 const pilihBarangSelect = document.querySelector(barangSelectId);
                 const deskripsiBarangTextarea = document.querySelector(deskripsiTextareaId);
                 const listBarangDiajukan = document.querySelector(listUlId);

                 if (tambahBarangBtn && pilihBarangSelect && deskripsiBarangTextarea && listBarangDiajukan) {
                     tambahBarangBtn.addEventListener('click', function() {
                         const selectedOption = pilihBarangSelect.options[pilihBarangSelect.selectedIndex];
                         const selectedBarangNama = selectedOption.dataset.nama;
                         const selectedBarangDeskripsi = deskripsiBarangTextarea.value || "Tidak ada deskripsi.";

                         const li = document.createElement('li');
                         li.className = 'p-3 border rounded-lg';
                         li.innerHTML = `
                             <div class="flex justify-between items-start">
                                 <div>
                                     <p class="font-medium text-gray-800">${selectedBarangNama}</p>
                                     <p class="text-sm text-gray-600 italic mt-1">"${selectedBarangDeskripsi}"</p>
                                 </div>
                                 <button type="button" class="text-red-500 hover:text-red-700 ml-2 remove-barang-btn"><i class="fas fa-trash"></i></button>
                             </div>
                         `;
                         listBarangDiajukan.appendChild(li);
                         li.querySelector('.remove-barang-btn').addEventListener('click', function() { li.remove(); });
                         deskripsiBarangTextarea.value = ''; // Clear textarea
                     });

                     // Handler untuk tombol hapus item awal
                     const initialRemoveBtns = listBarangDiajukan.querySelectorAll('.remove-barang-btn');
                     initialRemoveBtns.forEach(btn => {
                         btn.addEventListener('click', function() {
                             this.closest('li').remove();
                         });
                     });
                 }
             }
             setupPengajuanForm('pw'); // Setup for Perawatan
             setupPengajuanForm('pb'); // Setup for Perbaikan

            // --- LOGIKA MOCKUP KALENDER (UPDATED) ---
            const calendarDays = document.querySelectorAll('.calendar-day');
            const detailTanggal = document.getElementById('detail-tanggal');
            const detailListUl = document.getElementById('detail-list-ul');

            if (calendarDays.length > 0) {
                calendarDays.forEach(day => {
                    day.addEventListener('click', function() {
                        const dayNumber = this.dataset.date || this.textContent.trim().match(/^\d+/)?.[0]; // Get only number
                        const hasSchedule = this.classList.contains('has-schedule');
                        if (!dayNumber || this.classList.contains('text-gray-400')) return;

                        detailTanggal.textContent = `Detail untuk Tanggal ${dayNumber} Oktober 2025`;
                        detailListUl.innerHTML = '';

                        if (hasSchedule) {
                             const data = scheduleData[dayNumber];
                             if (data) {
                                 data.forEach(item => {
                                     let priorityClass = '';
                                     if (item.priority === 'high') {
                                         priorityClass = 'detail-item-high';
                                     } else if (item.priority === 'medium') {
                                         priorityClass = 'detail-item-medium';
                                     } else {
                                         priorityClass = 'detail-item-low';
                                     }

                                     const li = document.createElement('li');
                                     li.className = `detail-item ${priorityClass}`;
                                     li.innerHTML = `
                                         <div>
                                             <p class="font-medium">${item.barang}</p>
                                             <p class="text-xs opacity-80">${item.satker}</p>
                                         </div>
                                         <span class="priority-tag ${item.priority === 'high' ? 'priority-high' : (item.priority === 'medium' ? 'priority-medium' : 'priority-low')}">${item.priority.charAt(0).toUpperCase() + item.priority.slice(1)}</span>
                                     `;
                                     detailListUl.appendChild(li);
                                 });
                             } else {
                                 detailListUl.innerHTML = '<li class="p-2 text-center text-gray-500">Tidak ada jadwal.</li>';
                             }
                        } else {
                            detailListUl.innerHTML = '<li class="p-2 text-center text-gray-500">Tidak ada jadwal.</li>';
                        }
                    });
                });
            }

            // --- DATA MOCKUP DETAIL PENGAJUAN (Perawatan & Perbaikan) ---
            // Added reasonForRejection to data structure
            const detailData = {
                "JTI-01324": {
                    title: "Detail Pengajuan Perawatan: JTI-01324",
                    status: "menunggu",
                    reasonForRejection: null,
                    info: `<div><p class="text-sm text-gray-500">ID Pengajuan</p><p class="font-medium text-gray-800">JTI-01324</p></div><div><p class="text-sm text-gray-500">Nama Pengajuan</p><p class="font-medium text-gray-800">Pengajuan Triwulan JTI 2025</p></div><div><p class="text-sm text-gray-500">Satuan Kerja</p><p class="font-medium text-gray-800">Administrasi Niaga</p></div><div><p class="text-sm text-gray-500">Nomor Proposal</p><p class="font-medium text-gray-800">KL/ADM-0923</p></div><div><p class="text-sm text-gray-500">Tgl. Pelaksanaan</p><p class="font-medium text-gray-800">13 Oktober 2025</p></div><div><p class="text-sm text-gray-500">Status</p><span class="bg-yellow-100 text-yellow-700 text-sm font-medium px-2 py-1 rounded-full">Menunggu Persetujuan</span></div><div class="col-span-1 sm:col-span-2"><p class="text-sm text-gray-500">Deskripsi</p><p class="font-medium text-gray-800">Perawatan rutin untuk barang-barang elektronik di lab JTI.</p></div>`,
                    barang: `<tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300"></td><td class="p-3 text-sm text-gray-700">BRG-013</td><td class="p-3 text-sm font-medium text-gray-800"><a href="#detail-barang" data-target="#detail-barang" data-id="BRG-013" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Epson 13124</a></td><td class="p-3 text-sm text-gray-600">"Tinta bocor"</td><td class="p-3 text-center space-x-2"><button class="text-blue-500 hover:text-blue-700" title="Upload/Lihat Foto"><i class="fas fa-camera"></i></button><button class="text-gray-500 hover:text-gray-700" title="Download QR Code"><i class="fas fa-qrcode"></i></button></td></tr><tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300"></td><td class="p-3 text-sm text-gray-700">BRG-002</td><td class="p-3 text-sm font-medium text-gray-800"><a href="#detail-barang" data-target="#detail-barang" data-id="BRG-002" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Papan Tulis 7584</a></td><td class="p-3 text-sm text-gray-600">"Kusam"</td><td class="p-3 text-center space-x-2"><button class="text-blue-500 hover:text-blue-700" title="Upload/Lihat Foto"><i class="fas fa-camera"></i></button><button class="text-gray-500 hover:text-gray-700" title="Download QR Code"><i class="fas fa-qrcode"></i></button></td></tr>`,
                    timeline: `<div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-paper-plane"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Dibuat</h3><p class="text-sm text-gray-600">Oleh: User AN</p><time class="text-sm font-normal text-gray-500">10 Okt 2025, 09:30</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-yellow"><i class="fas fa-camera"></i></span><h3 class="font-semibold text-gray-800">Foto Diupload (2)</h3><p class="text-sm text-gray-600">Oleh: User AN</p><div class="mt-2 space-y-1"><div class="timeline-attachment text-sm"><i class="fas fa-file-image"></i> <span>foto_epson.jpg</span></div></div><time class="text-sm font-normal text-gray-500">10 Okt 2025, 10:15</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-gray"><i class="fas fa-hourglass-half"></i></span><h3 class="font-semibold text-gray-600">Menunggu Persetujuan</h3><p class="text-sm text-gray-600">Oleh: Admin UPA</p></div>`,
                    catatan: `<div class="bg-gray-100 p-2 rounded text-sm text-gray-700"><p class="font-medium">User AN (10 Okt 2025):</p><p>Mohon segera diproses untuk perawatan rutin.</p></div>`
                },
                 "SIPL-01326": { // Contoh Ditolak
                    title: "Detail Pengajuan Perawatan: SIPL-01326",
                    status: "ditolak",
                    reasonForRejection: "Anggaran untuk pengecatan ulang belum tersedia di triwulan ini. Mohon ajukan kembali di triwulan berikutnya.",
                    info: `<div><p class="text-sm text-gray-500">ID Pengajuan</p><p class="font-medium text-gray-800">SIPL-01326</p></div><div><p class="text-sm text-gray-500">Nama Pengajuan</p><p class="font-medium text-gray-800">Pengecatan Ruang Kelas Sipil</p></div><div><p class="text-sm text-gray-500">Satuan Kerja</p><p class="font-medium text-gray-800">Teknik Sipil</p></div><div><p class="text-sm text-gray-500">Nomor Proposal</p><p class="font-medium text-gray-800">KD-09872</p></div><div><p class="text-sm text-gray-500">Tgl. Pengajuan</p><p class="font-medium text-gray-800">15 Oktober 2025</p></div><div><p class="text-sm text-gray-500">Status</p><span class="bg-red-100 text-red-700 text-sm font-medium px-2 py-1 rounded-full">Ditolak</span></div><div class="col-span-1 sm:col-span-2"><p class="text-sm text-gray-500">Deskripsi</p><p class="font-medium text-gray-800">Pengecatan ulang dinding kelas A1 dan A2.</p></div>`,
                    barang: `<tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300" disabled></td><td class="p-3 text-sm text-gray-700">-</td><td class="p-3 text-sm font-medium text-gray-800">Pengecatan Dinding</td><td class="p-3 text-sm text-gray-600">"Warna sudah pudar"</td><td class="p-3 text-center space-x-2"><button class="text-gray-400 cursor-not-allowed" title="Foto"><i class="fas fa-camera"></i></button><button class="text-gray-400 cursor-not-allowed" title="QR Code"><i class="fas fa-qrcode"></i></button></td></tr>`,
                    timeline: `<div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-paper-plane"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Dibuat</h3><p class="text-sm text-gray-600">Oleh: User Sipil</p><time class="text-sm font-normal text-gray-500">15 Okt 2025, 14:00</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-red"><i class="fas fa-times"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Ditolak</h3><p class="text-sm text-gray-600">Oleh: Admin UPA</p><time class="text-sm font-normal text-gray-500">16 Okt 2025, 09:00</time></div>`,
                    catatan: ''
                },
                 "PBK-001": { // Contoh Perbaikan Selesai
                    title: "Detail Pengajuan Perbaikan: PBK-001",
                    status: "selesai",
                    reasonForRejection: null,
                    info: `<div><p class="text-sm text-gray-500">ID Pengajuan</p><p class="font-medium text-gray-800">PBK-001</p></div><div><p class="text-sm text-gray-500">Nama Pengajuan</p><p class="font-medium text-gray-800">Perbaikan AC Ruang 712</p></div><div><p class="text-sm text-gray-500">Satuan Kerja</p><p class="font-medium text-gray-800">Teknik Elektro</p></div><div><p class="text-sm text-gray-500">Nomor Surat</p><p class="font-medium text-gray-800">-</p></div><div><p class="text-sm text-gray-500">Tgl. Pengajuan</p><p class="font-medium text-gray-800">11 Oktober 2025</p></div><div><p class="text-sm text-gray-500">Status</p><span class="bg-green-100 text-green-700 text-sm font-medium px-2 py-1 rounded-full">Selesai</span></div><div class="col-span-1 sm:col-span-2"><p class="text-sm text-gray-500">Deskripsi</p><p class="font-medium text-gray-800">AC mati total, tidak bisa menyala.</p></div>`,
                    barang: `<tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300" checked disabled></td><td class="p-3 text-sm text-gray-700">BRG-034</td><td class="p-3 text-sm font-medium text-gray-800"><a href="#detail-barang" data-target="#detail-barang" data-id="BRG-034" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">AC Ruang 712</a></td><td class="p-3 text-sm text-gray-600">"Mati total"</td><td class="p-3 text-center space-x-2"><button class="text-green-500" title="Foto Terverifikasi"><i class="fas fa-check-circle"></i></button><button class="text-gray-500 hover:text-gray-700" title="Download QR Code"><i class="fas fa-qrcode"></i></button></td></tr>`,
                    timeline: `<div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-paper-plane"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Dibuat</h3><p class="text-sm text-gray-600">Oleh: User Elektro</p><time class="text-sm font-normal text-gray-500">11 Okt 2025, 10:00</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-yellow"><i class="fas fa-camera"></i></span><h3 class="font-semibold text-gray-800">Foto Bukti Diupload</h3><p class="text-sm text-gray-600">Oleh: User Elektro</p><div class="mt-2 space-y-1"><div class="timeline-attachment text-sm"><i class="fas fa-file-image"></i> <span>ac_mati.jpg</span></div></div><time class="text-sm font-normal text-gray-500">11 Okt 2025, 10:05</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-green"><i class="fas fa-check"></i></span><h3 class="font-semibold text-gray-800">Disetujui & Diverifikasi</h3><p class="text-sm text-gray-600">Oleh: Admin UPA</p><time class="text-sm font-normal text-gray-500">11 Okt 2025, 11:30</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-green"><i class="fas fa-check-double"></i></span><h3 class="font-semibold text-gray-800">Pelaksanaan Selesai</h3><p class="text-sm text-gray-600">Oleh: Teknisi JTI</p><time class="text-sm font-normal text-gray-500">13 Okt 2025, 14:00</time></div>`, // Updated technician name in timeline if applicable
                    catatan: `<div class="bg-gray-100 p-2 rounded text-sm text-gray-700"><p class="font-medium">Teknisi JTI (13 Okt 2025):</p><p>Kompresor AC diganti, sudah berfungsi normal kembali.</p></div>`
                },
                 "PBK-002": { // Contoh Perbaikan Dikerjakan
                    title: "Detail Pengajuan Perbaikan: PBK-002",
                    status: "dikerjakan",
                    reasonForRejection: null,
                    info: `<div><p class="text-sm text-gray-500">ID Pengajuan</p><p class="font-medium text-gray-800">PBK-002</p></div><div><p class="text-sm text-gray-500">Nama Pengajuan</p><p class="font-medium text-gray-800">Perbaikan Pintu Lab Jaringan</p></div><div><p class="text-sm text-gray-500">Satuan Kerja</p><p class="font-medium text-gray-800">JTI</p></div><div><p class="text-sm text-gray-500">Nomor Surat</p><p class="font-medium text-gray-800">-</p></div><div><p class="text-sm text-gray-500">Tgl. Pengajuan</p><p class="font-medium text-gray-800">25 Oktober 2025</p></div><div><p class="text-sm text-gray-500">Status</p><span class="bg-blue-100 text-blue-700 text-sm font-medium px-2 py-1 rounded-full">Sedang Dikerjakan</span></div><div class="col-span-1 sm:col-span-2"><p class="text-sm text-gray-500">Deskripsi</p><p class="font-medium text-gray-800">Engsel pintu lepas.</p></div>`,
                    barang: `<tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300"></td><td class="p-3 text-sm text-gray-700">-</td><td class="p-3 text-sm font-medium text-gray-800">Pintu Lab Jaringan</td><td class="p-3 text-sm text-gray-600">"Engsel lepas"</td><td class="p-3 text-center space-x-2"><button class="text-blue-500 hover:text-blue-700" title="Upload/Lihat Foto"><i class="fas fa-camera"></i></button><button class="text-gray-500 hover:text-gray-700" title="Download QR Code"><i class="fas fa-qrcode"></i></button></td></tr>`,
                    timeline: `<div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-paper-plane"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Dibuat</h3><p class="text-sm text-gray-600">Oleh: User JTI</p><time class="text-sm font-normal text-gray-500">25 Okt 2025, 08:00</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-green"><i class="fas fa-check"></i></span><h3 class="font-semibold text-gray-800">Disetujui & Diverifikasi</h3><p class="text-sm text-gray-600">Oleh: Admin UPA</p><time class="text-sm font-normal text-gray-500">25 Okt 2025, 09:30</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-spinner fa-spin"></i></span><h3 class="font-semibold text-gray-800">Sedang Dikerjakan</h3><p class="text-sm text-gray-600">Oleh: Teknisi JTI</p><time class="text-sm font-normal text-gray-500">Dimulai 26 Okt 2025, 10:00</time></div>`,
                    catatan: `` // Kosong
                },
                 "AN-01325": {
                    title: "Detail Pengajuan Perawatan: AN-01325",
                    status: "disetujui",
                    reasonForRejection: null,
                    info: `<div><p class="text-sm text-gray-500">ID Pengajuan</p><p class="font-medium text-gray-800">AN-01325</p></div><div><p class="text-sm text-gray-500">Nama Pengajuan</p><p class="font-medium text-gray-800">Perbaikan Kursi AN 2025</p></div><div><p class="text-sm text-gray-500">Satuan Kerja</p><p class="font-medium text-gray-800">Administrasi Niaga</p></div><div><p class="text-sm text-gray-500">Nomor Proposal</p><p class="font-medium text-gray-800">KD-09872</p></div><div><p class="text-sm text-gray-500">Tgl. Pengajuan</p><p class="font-medium text-gray-800">9 Oktober 2025</p></div><div><p class="text-sm text-gray-500">Status</p><span class="bg-green-100 text-green-700 text-sm font-medium px-2 py-1 rounded-full">Disetujui</span></div><div class="col-span-1 sm:col-span-2"><p class="text-sm text-gray-500">Deskripsi</p><p class="font-medium text-gray-800">Perbaikan kaki kursi yang goyang (10 unit).</p></div>`,
                    barang: `<tr><td class="p-3"><input type="checkbox" class="rounded border-gray-300" checked disabled></td><td class="p-3 text-sm text-gray-700">BRG-012</td><td class="p-3 text-sm font-medium text-gray-800"><a href="#detail-barang" data-target="#detail-barang" data-id="BRG-012" class="menu-link detail-barang-link text-blue-600 font-medium hover:underline">Kursi Lab LSI 2</a></td><td class="p-3 text-sm text-gray-600">"Kaki goyang (10 unit)"</td><td class="p-3 text-center space-x-2"><button class="text-green-500" title="Foto Terverifikasi"><i class="fas fa-check-circle"></i></button><button class="text-gray-500 hover:text-gray-700" title="Download QR Code"><i class="fas fa-qrcode"></i></button></td></tr>`,
                    timeline: `<div class="timeline-item"><span class="timeline-dot timeline-dot-blue"><i class="fas fa-paper-plane"></i></span><h3 class="font-semibold text-gray-800">Pengajuan Dibuat</h3><p class="text-sm text-gray-600">Oleh: User AN</p><time class="text-sm font-normal text-gray-500">9 Okt 2025, 11:00</time></div><div class="timeline-item"><span class="timeline-dot timeline-dot-green"><i class="fas fa-check"></i></span><h3 class="font-semibold text-gray-800">Disetujui & Diverifikasi</h3><p class="text-sm text-gray-600">Oleh: Admin UPA</p><time class="text-sm font-normal text-gray-500">9 Okt 2025, 15:30</time></div>`,
                    catatan: ``
                 }
            };

            // --- FUNGSI UNTUK LOAD DETAIL PENGAJUAN (UPDATED) ---
            function loadDetailPengajuan(id, status, isPerawatan) {
                const data = detailData[id];
                const pageId = isPerawatan ? '#detail-riwayat-perawatan' : '#detail-riwayat-perbaikan';
                const titleId = isPerawatan ? '#detail-title-perawatan' : '#detail-title-perbaikan';
                const infoContainerId = isPerawatan ? '#detail-info-perawatan' : '#detail-info-perbaikan';
                const barangTableId = isPerawatan ? '#detail-barang-table-perawatan' : '#detail-barang-table-perbaikan';
                const timelineContainerId = isPerawatan ? '#detail-timeline-perawatan' : '#detail-timeline-perbaikan';
                const catatanContainerId = isPerawatan ? '#catatan-tersimpan-perawatan' : '#catatan-tersimpan-perbaikan';
                 const verifikasiBtnId = isPerawatan ? '#verifikasi-btn-perawatan' : '#verifikasi-btn-perbaikan';
                 const barangCardId = isPerawatan ? '#detail-barang-card-perawatan' : '#detail-barang-card-perbaikan';
                 const adminActionsId = isPerawatan ? '#admin-actions-perawatan' : '#admin-actions-perbaikan';
                 const alasanPenolakanCard = isPerawatan ? document.getElementById('catatan-penolakan-perawatan') : document.getElementById('catatan-penolakan-perbaikan');
                 const alasanPenolakanText = isPerawatan ? document.getElementById('alasan-penolakan-text-perawatan') : document.getElementById('alasan-penolakan-text-perbaikan');

                const adminActionsContainer = document.querySelector(adminActionsId);

                if (!data) {
                    console.error("Data detail tidak ditemukan untuk ID:", id);
                     if(adminActionsContainer) adminActionsContainer.classList.add('hidden');
                    return;
                }

                 // Update Judul & Breadcrumb
                document.querySelector(titleId).textContent = data.title;
                 let breadcrumbPrefix = isPerawatan ? 'Perawatan<span>/</span>Riwayat Pengajuan' : 'Perbaikan<span>/</span>Riwayat Pengajuan';
                 if (status === 'selesai') {
                      breadcrumbPrefix = isPerawatan ? 'Perawatan<span>/</span>Riwayat Pelaksanaan' : 'Perbaikan<span>/</span>Riwayat Pelaksanaan';
                 }
                 let newBreadcrumb = `${breadcrumbPrefix}<span>/</span>Detail: ${id}`;
                 document.querySelector(pageId + ' .breadcrumbs').innerHTML = newBreadcrumb;


                document.querySelector(infoContainerId).innerHTML = data.info;
                document.querySelector(barangTableId).innerHTML = data.barang;
                document.querySelector(timelineContainerId).innerHTML = data.timeline;
                document.querySelector(catatanContainerId).innerHTML = data.catatan || '';


                 // LOGIKA ALASAN PENOLAKAN
                 if (status === 'ditolak' && data.reasonForRejection) {
                      alasanPenolakanText.textContent = data.reasonForRejection;
                      alasanPenolakanCard.classList.remove('hidden');
                 } else {
                      alasanPenolakanCard.classList.add('hidden');
                 }


                 // Tampilkan/sembunyikan card barang & tombol verifikasi berdasarkan status
                 const verifikasiBtn = document.querySelector(verifikasiBtnId);
                 const barangCard = document.querySelector(barangCardId);

                if (status === 'ditolak' || status === 'selesai') {
                    verifikasiBtn.classList.add('hidden');
                     if (status === 'ditolak') {
                          barangCard.classList.add('hidden');
                     } else {
                          barangCard.classList.remove('hidden');
                          // Disable checkbox di tabel barang jika sudah selesai
                          barangCard.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = true);
                     }
                } else {
                        barangCard.classList.remove('hidden');
                        verifikasiBtn.classList.remove('hidden'); // Tampilkan tombol verifikasi jika belum selesai/ditolak
                        barangCard.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.disabled = false); // Enable checkbox
                }

                 // Tampilkan/sembunyikan tombol aksi admin berdasarkan status
                if (adminActionsContainer) {
                    if (status === 'menunggu') {
                        adminActionsContainer.classList.remove('hidden');
                    } else {
                        adminActionsContainer.classList.add('hidden');
                    }
                }

                 // Re-attach event listener untuk link detail barang di dalam tabel detail
                 attachDetailBarangListeners(barangTableId);
            }

          // --- DATA MOCKUP DETAIL BARANG ---
      const barangData = {
        "BRG-001": {
          title: "Detail Barang: BRG-001",
          info: `<div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-barcode"></i></div><div><p class="text-sm text-gray-500">ID Barang</p><p class="font-medium text-gray-800">BRG-001</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-box"></i></div><div><p class="text-sm text-gray-500">Nama Barang</p><p class="font-medium text-gray-800">Komputer Apple Lab LSI 2</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-map-marker-alt"></i></div><div><p class="text-sm text-gray-500">Lokasi</p><p class="font-medium text-gray-800">Gedung Elektro / Lt. 7 / Lab LSI 2</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-heartbeat"></i></div><div><p class="text-sm text-gray-500">Kondisi Saat Ini</p><span class="bg-green-100 text-green-700 text-sm font-medium px-2 py-1 rounded-full">Baik</span></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-calendar-alt"></i></div><div><p class="text-sm text-gray-500">Tgl. Perolehan</p><p class="font-medium text-gray-800">2020-01-15</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-industry"></i></div><div><p class="text-sm text-gray-500">Merk/Tipe</p><p class="font-medium text-gray-800">Apple / Macbook Pro</p></div></div>`,
          riwayat: `
            <tr>
              <td class="p-3 text-sm text-gray-700">15-09-2025</td>
              <td class="p-3 text-sm text-green-600">Perawatan</td>
              <td class="p-3 text-sm text-gray-700">Pembersihan unit, update OS</td>
              <td class="p-3 text-sm text-green-600">Selesai</td>
              <td class="p-3 text-center"><button class="text-blue-500 hover:text-blue-700 text-lg"><i class="fas fa-info-circle"></i></button></td>
            </tr>
            <tr>
              <td class="p-3 text-sm text-gray-700">01-03-2024</td>
              <td class="p-3 text-sm text-yellow-600">Perbaikan</td>
              <td class="p-3 text-sm text-gray-700">Ganti keyboard</td>
              <td class="p-3 text-sm text-green-600">Selesai</td>
              <td class="p-3 text-center"><button class="text-blue-500 hover:text-blue-700 text-lg"><i class="fas fa-info-circle"></i></button></td>
            </tr>
          `,
          jadwal: `<p class="font-medium text-gray-800">15 Maret 2026</p><p class="text-sm text-gray-600">Perawatan Rutin 6 Bulanan (Prioritas Medium)</p>`
        },
        "BRG-002": {
          title: "Detail Barang: BRG-002",
          info: `<div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-barcode"></i></div><div><p class="text-sm text-gray-500">ID Barang</p><p class="font-medium text-gray-800">BRG-002</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-box"></i></div><div><p class="text-sm text-gray-500">Nama Barang</p><p class="font-medium text-gray-800">Papan Tulis 7584</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-map-marker-alt"></i></div><div><p class="text-sm text-gray-500">Lokasi</p><p class="font-medium text-gray-800">Gedung Elektro / Lt. 7 / Ruang 712</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-heartbeat"></i></div><div><p class="text-sm text-gray-500">Kondisi Saat Ini</p><span class="bg-yellow-100 text-yellow-700 text-sm font-medium px-2 py-1 rounded-full">Perlu Perawatan</span></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-calendar-alt"></i></div><div><p class="text-sm text-gray-500">Tgl. Perolehan</p><p class="font-medium text-gray-800">2022-10-01</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-industry"></i></div><div><p class="text-sm text-gray-500">Merk/Tipe</p><p class="font-medium text-gray-800">Lokal / Whiteboard</p></div></div>`,
          riwayat: `
            <tr><td colspan="5" class="p-4 text-center text-gray-500">Belum ada riwayat tercatat.</td></tr>
          `,
          jadwal: `<p class="font-medium text-gray-800">5 November 2025</p><p class="text-sm text-gray-600">Pembersihan Papan Tulis (Prioritas Rendah)</p>`
        },
        "BRG-017": {
          title: "Detail Barang: BRG-017",
          info: `<div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-barcode"></i></div><div><p class="text-sm text-gray-500">ID Barang</p><p class="font-medium text-gray-800">BRG-017</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-box"></i></div><div><p class="text-sm text-gray-500">Nama Barang</p><p class="font-medium text-gray-800">Proyektor Ruang 712</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-map-marker-alt"></i></div><div><p class="text-sm text-gray-500">Lokasi</p><p class="font-medium text-gray-800">Gedung Elektro / Lt. 7 / Ruang 712</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-heartbeat"></i></div><div><p class="text-sm text-gray-500">Kondisi Saat Ini</p><span class="bg-red-100 text-red-700 text-sm font-medium px-2 py-1 rounded-full">Rusak Berat</span></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-calendar-alt"></i></div><div><p class="text-sm text-gray-500">Tgl. Perolehan</p><p class="font-medium text-gray-800">2019-05-20</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-industry"></i></div><div><p class="text-sm text-gray-500">Merk/Tipe</p><p class="font-medium text-gray-800">Epson / EB-L200</p></div></div>`,
          riwayat: `
            <tr>
              <td class="p-3 text-sm text-gray-700">10-10-2025</td>
              <td class="p-3 text-sm text-yellow-600">Perbaikan</td>
              <td class="p-3 text-sm text-gray-700">Pergantian Lampu.</td>
              <td class="p-3 text-sm text-green-600">Selesai</td>
              <td class="p-3 text-center"><button class="text-blue-500 hover:text-blue-700 text-lg"><i class="fas fa-info-circle"></i></button></td>
            </tr>
          `,
          jadwal: `<p class="font-medium text-gray-800">17 November 2025</p><p class="text-sm text-gray-600">Perawatan Lensa Proyektor (Prioritas Tinggi)</p>`
        },
        "BRG-034": {
          title: "Detail Barang: BRG-034",
          info: `<div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-barcode"></i></div><div><p class="text-sm text-gray-500">ID Barang</p><p class="font-medium text-gray-800">BRG-034</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-box"></i></div><div><p class="text-sm text-gray-500">Nama Barang</p><p class="font-medium text-gray-800">AC Ruang 712</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-map-marker-alt"></i></div><div><p class="text-sm text-gray-500">Lokasi</p><p class="font-medium text-gray-800">Gedung Elektro / Lt. 7 / Ruang 712</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-heartbeat"></i></div><div><p class="text-sm text-gray-500">Kondisi Saat Ini</p><span class="bg-green-100 text-green-700 text-sm font-medium px-2 py-1 rounded-full">Baik</span></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-calendar-alt"></i></div><div><p class="text-sm text-gray-500">Tgl. Perolehan</p><p class="font-medium text-gray-800">2021-08-10</p></div></div><div class="flex items-center gap-4"><div class="text-blue-600 text-xl w-6 text-center"><i class="fas fa-industry"></i></div><div><p class="text-sm text-gray-500">Merk/Tipe</p><p class="font-medium text-gray-800">Daikin / FTKQ15SVM4</p></div></div>`,
          riwayat: `
            <tr>
              <td class="p-3 text-sm text-gray-700">13-10-2025</td>
              <td class="p-3 text-sm text-red-600">Perbaikan</td>
              <td class="p-3 text-sm text-gray-700">Ganti Kompresor</td>
              <td class="p-3 text-sm text-green-600">Selesai</td>
              <td class="p-3 text-center"><button class="text-blue-500 hover:text-blue-700 text-lg"><i class="fas fa-info-circle"></i></button></td>
            </tr>
          `,
          jadwal: `<p class="font-medium text-gray-800">Belum ada jadwal perawatan rutin.</p><p class="text-sm text-red-600">Direkomendasikan 3 bulanan.</p>`
        }
        // ... tambahkan data barang lain jika perlu
      };

      // --- FUNGSI UNTUK LOAD DETAIL BARANG ---
      function loadDetailBarang(id) {
        const data = barangData[id];
        if (!data) {
          console.error("Data barang tidak ditemukan untuk ID:", id);
          return;
        }

        // Update Judul & Breadcrumb
        document.getElementById('detail-barang-title').textContent = data.title;
        let newBreadcrumb = `Master Data<span>/</span>Master Barang<span>/</span>Detail: ${id}`;
        document.getElementById('breadcrumb-detail-barang').innerHTML = newBreadcrumb;

        // Update Konten
        document.getElementById('detail-barang-info').innerHTML = data.info;
        document.getElementById('detail-barang-riwayat').innerHTML = data.riwayat;
        document.getElementById('detail-barang-jadwal').innerHTML = data.jadwal;
      }

      // --- FUNGSI UNTUK ATTACH LISTENER KE SEMUA DETAIL BARANG LINK ---
      function attachDetailBarangListeners(scope = 'body') {
        // Clear existing listeners before reattaching if scope is specific (like a table body)
        const links = document.querySelectorAll(`${scope} .detail-barang-link`);
        links.forEach(link => {
          // Clone the element to remove all previous listeners
          const newLink = link.cloneNode(true);
          link.parentNode.replaceChild(newLink, link);
          
          newLink.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            const detailId = this.dataset.id;
            
            // Navigasi & Load Detail
            showPage(targetId); // Cuma ganti halaman, breadcrumb akan diatur di loadDetailBarang
            loadDetailBarang(detailId);

            // Update Active Link di Sidebar (opsional, tergantung UX)
            allMenuLinks.forEach(l => l.classList.remove('active-link'));
            // Cari link 'Master Barang' dan set sebagai active-link
            const masterBarangLink = document.querySelector('a[href="#master-barang"]');
            if (masterBarangLink) {
              masterBarangLink.classList.add('active-link');
              const parentToggle = masterBarangLink.closest('.sub-menu')?.previousElementSibling;
              if (parentToggle) parentToggle.classList.add('active-link');
            }
          });
        });
      }

      // Attach listener secara global saat DOMContentLoaded
      attachDetailBarangListeners();

      // --- MODAL LOGIC: IMPORT BARANG ---
      const importModal = document.getElementById('import-barang-modal');
      const openImportBtn = document.getElementById('open-import-modal');
      const closeImportBtns = document.querySelectorAll('#close-import-modal, #cancel-import-barang');
      const importFileInput = document.getElementById('import-file-input');
      const fileStatus = document.getElementById('file-status-barang');
      const submitImportBtn = document.getElementById('submit-import-barang');

      if (openImportBtn) {
        openImportBtn.addEventListener('click', () => {
          importModal.classList.remove('hidden');
        });
      }

      closeImportBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          importModal.classList.add('hidden');
        });
      });

      if (importFileInput) {
        importFileInput.addEventListener('change', function() {
          if (this.files.length > 0) {
            fileStatus.textContent = `File dipilih: ${this.files[0].name}`;
            submitImportBtn.disabled = false;
          } else {
            fileStatus.textContent = `Belum ada file dipilih.`;
            submitImportBtn.disabled = true;
          }
        });
      }
      
      // --- MODAL LOGIC: TOLAK PENGAJUAN (Perawatan & Perbaikan) ---
      const tolakModal = document.getElementById('modal-tolak-pengajuan');
      const closeTolakModalBtns = document.querySelectorAll('#close-modal-tolak, #cancel-modal-tolak');
      const submitTolakModalBtn = document.getElementById('submit-modal-tolak');
      const alasanTolakInput = document.getElementById('alasan-tolak-input');
      
      // State untuk menyimpan jenis pengajuan
      let currentPengajuanType = null;
      let currentPengajuanId = null;

      function openTolakModal(type, id) {
        currentPengajuanType = type;
        currentPengajuanId = id;
        alasanTolakInput.value = ''; // Reset input
        tolakModal.classList.remove('hidden');
      }
      
      closeTolakModalBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          tolakModal.classList.add('hidden');
        });
      });

      submitTolakModalBtn.addEventListener('click', () => {
        const alasan = alasanTolakInput.value.trim();
        if (alasan === "") {
          alert("Alasan penolakan tidak boleh kosong.");
          return;
        }
        // Logic Penolakan Mockup:
        alert(`[MOCKUP] Pengajuan ID ${currentPengajuanId} (${currentPengajuanType}) DITOLAK dengan alasan: "${alasan}"`);
        
        // Update Mock Data & UI:
        if (detailData[currentPengajuanId]) {
          detailData[currentPengajuanId].status = 'ditolak';
          detailData[currentPengajuanId].reasonForRejection = alasan;
          // Reload detail page untuk melihat perubahan status
          loadDetailPengajuan(currentPengajuanId, 'ditolak', currentPengajuanType === 'perawatan');
        }
        
        tolakModal.classList.add('hidden');
      });

      // Event listener untuk tombol Tolak di Detail Pengajuan Perawatan/Perbaikan
      const btnTolakPerawatan = document.getElementById('btn-tolak-perawatan');
      const btnTolakPerbaikan = document.getElementById('btn-tolak-perbaikan');

      if (btnTolakPerawatan) {
        btnTolakPerawatan.addEventListener('click', () => {
          // Ambil ID dari Breadcrumb atau Title
          const idMatch = document.getElementById('detail-title-perawatan').textContent.match(/:\s*(\w+-\d+)/);
          const id = idMatch ? idMatch[1] : null;
          if (id) openTolakModal('perawatan', id);
        });
      }

      if (btnTolakPerbaikan) {
        btnTolakPerbaikan.addEventListener('click', () => {
          const idMatch = document.getElementById('detail-title-perbaikan').textContent.match(/:\s*(\w+-\d+)/);
          const id = idMatch ? idMatch[1] : null;
          if (id) openTolakModal('perbaikan', id);
        });
      }

     
      // Dummy Permission Structure (Module: [R (Read/View), C (Create/Request), U (Update/Approve), D (Delete/Execute)])
      const allPermissions = {
        "Dashboard": { R: "Akses Dashboard", C: false, U: false, D: false },
        "Master Barang": { R: "Lihat Barang", C: "Tambah/Import Barang", U: "Edit Barang", D: "Hapus Barang" },
        "Master Gedung/Ruang": { R: "Lihat Gedung/Ruang", C: "Tambah Gedung/Ruang", U: "Edit Gedung/Ruang", D: "Hapus Gedung/Ruang" },
        "Pengajuan Perawatan": { R: "Lihat Riwayat Ajuan", C: "Buat Pengajuan", U: "Setujui/Verifikasi Ajuan", D: "Tolak Ajuan/Batalkan" },
        "Pelaksanaan Perawatan": { R: "Lihat Riwayat Pelaksanaan", C: "Input Laporan Pelaksanaan", U: false, D: false },
        "Pengajuan Perbaikan": { R: "Lihat Riwayat Ajuan", C: "Buat Pengajuan", U: "Setujui/Verifikasi Ajuan", D: "Tolak Ajuan/Batalkan" },
        "Pelaksanaan Perbaikan": { R: "Lihat Riwayat Pelaksanaan", C: "Input Laporan Pelaksanaan", U: false, D: false },
        "User Management": { R: "Lihat Daftar User", C: "Tambah User", U: "Edit User", D: "Hapus User" },
        "Role Management": { R: "Lihat Daftar Role", C: "Tambah Role", U: "Edit Role & Hak Akses", D: "Hapus Role" },
      };

      // Mockup data for existing roles (true/false indicates permission status)
      const rolePermissions = {
        "Admin UPA": {
          "Dashboard": { R: true },
          "Master Barang": { R: true, C: true, U: true, D: true },
          "Master Gedung/Ruang": { R: true, C: true, U: true, D: true },
          "Pengajuan Perawatan": { R: true, C: true, U: true, D: true },
          "Pelaksanaan Perawatan": { R: true, C: true },
          "Pengajuan Perbaikan": { R: true, C: true, U: true, D: true },
          "Pelaksanaan Perbaikan": { R: true, C: true },
          "User Management": { R: true, C: true, U: true, D: true },
          "Role Management": { R: true, C: true, U: true, D: true }
        },
        "Teknisi": {
          "Dashboard": { R: true },
          "Master Barang": { R: true, C: false, U: false, D: false },
          "Master Gedung/Ruang": { R: true, C: false, U: false, D: false },
          "Pengajuan Perawatan": { R: true, C: false, U: false, D: false },
          "Pelaksanaan Perawatan": { R: true, C: true },
          "Pengajuan Perbaikan": { R: true, C: false, U: false, D: false },
          "Pelaksanaan Perbaikan": { R: true, C: true },
          "User Management": { R: false, C: false, U: false, D: false },
          "Role Management": { R: false, C: false, U: false, D: false }
        },
        "User Satker": {
          "Dashboard": { R: false },
          "Master Barang": { R: false, C: false, U: false, D: false },
          "Master Gedung/Ruang": { R: false, C: false, U: false, D: false },
          "Pengajuan Perawatan": { R: true, C: true, U: false, D: false },
          "Pelaksanaan Perawatan": { R: true, C: false },
          "Pengajuan Perbaikan": { R: true, C: true, U: false, D: false },
          "Pelaksanaan Perbaikan": { R: true, C: false },
          "User Management": { R: false, C: false, U: false, D: false },
          "Role Management": { R: false, C: false, U: false, D: false }
        }
      };

// --- FUNGSI BARU UNTUK MEMUAT HALAMAN HAK AKSES ---
// (Data allPermissions dan rolePermissions yang sudah ada di JS Anda tetap digunakan)

function loadHakAksesPage(roleName) {
    const titleEl = document.getElementById('edit-hak-akses-title');
    const breadcrumbEl = document.getElementById('breadcrumb-edit-hak-akses');
    const permissionListEl = document.getElementById('permission-list-page');
    const saveBtn = document.getElementById('save-hak-akses-page');

    if (!titleEl || !breadcrumbEl || !permissionListEl || !saveBtn) {
        console.error("Elemen halaman hak akses tidak ditemukan!");
        return;
    }

    // 1. Set Judul dan Breadcrumb
    titleEl.textContent = `Atur Hak Akses: ${roleName}`;
    // Ambil breadcrumb dari link yang diklik, atau set manual
    const activeLink = document.querySelector(`a[data-role-name="${roleName}"]`);
    if (activeLink && activeLink.dataset.breadcrumb) {
         breadcrumbEl.innerHTML = activeLink.dataset.breadcrumb;
    } else {
         breadcrumbEl.innerHTML = `User & Hak Akses<span>/</span>Master Role<span>/</span><strong>${roleName}</strong>`;
    }
    
    // 2. Populate list (Logika disalin dari openPermissionModal lama)
    permissionListEl.innerHTML = ''; // Kosongkan
    const currentPermissions = rolePermissions[roleName] || {};
    
    for (const module in allPermissions) {
        const perms = allPermissions[module];
        const currentModulePerms = currentPermissions[module] || {};
        
        // --- PERHATIKAN BAGIAN INI ---
        // 'div' di bawah ini adalah yang membuat tata letak 2 kolom
        let moduleHtml = `<div class="border border-gray-200 rounded-lg p-3">
            <h4 class="text-lg font-bold text-gray-800 mb-3 border-b pb-2">${module}</h4>
            <div class="grid grid-cols-2 gap-4">`; // <-- INI KUNCINYA
        
        for (const action in perms) {
            if (perms[action]) {
                const isChecked = currentModulePerms[action] === true;
                const actionLabel = perms[action];
                moduleHtml += `
                    <div class="flex items-center">
                        <input type="checkbox" id="${roleName}-${module}-${action}" 
                            class="form-checkbox h-5 w-5 text-blue-600 rounded" 
                            data-module="${module}" data-action="${action}" 
                            ${isChecked ? 'checked' : ''}>
                        <label for="${roleName}-${module}-${action}" class="ml-2 text-sm text-gray-700">${actionLabel}</label>
                    </div>`;
            }
        }
        moduleHtml += `</div></div>`; // <-- Penutup 'div' grid
        permissionListEl.innerHTML += moduleHtml;
    }

    // 3. Setup Tombol Save
    // *Penting*: Hapus event listener lama agar tidak menumpuk
    const newSaveBtn = saveBtn.cloneNode(true);
    saveBtn.parentNode.replaceChild(newSaveBtn, saveBtn);
    
    newSaveBtn.addEventListener('click', () => {
        // (Logika save disalin dari saveHakAksesModalBtn lama)
        const newPermissions = {};
        let hasChanges = false;
        
        permissionListEl.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            const module = checkbox.dataset.module;
            const action = checkbox.dataset.action;
            
            if (!newPermissions[module]) {
                newPermissions[module] = {};
            }
            
            const isChecked = checkbox.checked;
            newPermissions[module][action] = isChecked;

            // Cek jika ada perubahan
            if ((rolePermissions[roleName]?.[module]?.[action] || false) !== isChecked) {
                hasChanges = true;
            }
        });

        if (hasChanges) {
            rolePermissions[roleName] = newPermissions;
            alert(`[MOCKUP] Hak Akses untuk Role "${roleName}" berhasil diperbarui!`);
            // Navigasi kembali ke master role
            document.querySelector('a[href="#master-role"]').click();
        } else {
            alert("Tidak ada perubahan yang disimpan.");
        }
    });
}
      
      });
   
  </script>
</body>
</html>
